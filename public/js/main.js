!function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";n.runAnimations=!1,n.pop=!0,n.canvasId="canvas",n.maxShapes=20,n.palette={colors:["#20171C","#1E2A43","#28377D","#352747","#CA2E26","#9A2A1F","#DA6C26","#453121","#916A47","#DAAD27","#7F7D31","#2B5E2E"],colorNames:{"#20171C":"black","#1E2A43":"blue","#28377D":"blue","#352747":"blue","#CA2E26":"red","#9A2A1F":"red","#DA6C26":"orange","#453121":"brown","#916A47":"brown","#DAAD27":"orange","#7F7D31":"green","#2B5E2E":"green"},gradients:{"#20171C":["#20171C","#000000"],"#1E2A43":["#1E2A43","#263166"],"#28377D":["#28377D","#1E4695"],"#352747":["#352747","#45005B"],"#CA2E26":["#CA2E26","#9B352F"],"#9A2A1F":["#9A2A1F","#CD3621"],"#DA6C26":["#DA6C26","#BD4820"],"#453121":["#453121","#281806"],"#916A47":["#916A47","#623A22"],"#DAAD27":["#DAAD27","#AF871D"],"#7F7D31":["#7F7D31","#555827"],"#2B5E2E":["#2B5E2E","#16451D"]},pops:["#00ADEF","#F285A5","#7DC57F","#F6EB16","#F4EAE0"],colorSize:20,selectedColorSize:30},n.contextualTuts=[{type:"fill",copy:"<strong>Double-tap</strong> a filled shape to <strong>UNFILL</strong> it. Repeat to <strong>FILL</strong> an unfilled shape."},{type:"pinch",copy:"<strong>Pinch</strong> shapes with <strong>TWO FINGERS</strong> to <strong>resize</strong> and <strong>move</strong> them."},{type:"swipe",copy:"To <strong>remove</strong> shapes, <strong>pinch</strong> with <strong>two fingers</strong> then <strong>swipe</strong> or hit <strong>undo</strong>."}]},{}],2:[function(t,e,n){(function(t,i){!function(t){if("object"==typeof n&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o;"undefined"!=typeof window?o=window:"undefined"!=typeof i?o=i:"undefined"!=typeof self&&(o=self),o.Promise=t()}}(function(){var e,n,o;return function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof _dereq_&&_dereq_;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof _dereq_&&_dereq_,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";e.exports=function(t){function e(t){var e=new n(t),i=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),i}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(e,n,i){"use strict";function o(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=l}function r(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function a(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function s(t){this._normalQueue._pushOne(t),this._queueTick()}var u;try{throw new Error}catch(t){u=t}var l=e("./schedule"),c=e("./queue"),p=e("./util");o.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},o.prototype.hasCustomScheduler=function(){return this._customScheduler},o.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},o.prototype.disableTrampolineIfNecessary=function(){p.hasDevTools&&(this._trampolineEnabled=!1)},o.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},o.prototype.fatalError=function(e,n){n?(t.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),t.exit(2)):this.throwLater(e)},o.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},p.hasDevTools?(o.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?r.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},o.prototype.invoke=function(t,e,n){this._trampolineEnabled?a.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},o.prototype.settlePromises=function(t){this._trampolineEnabled?s.call(this,t):this._schedule(function(){t._settlePromises()})}):(o.prototype.invokeLater=r,o.prototype.invoke=a,o.prototype.settlePromises=s),o.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),i=t.shift();e.call(n,i)}else e._settlePromises()}},o.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},o.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},o.prototype._reset=function(){this._isTickUsed=!1},n.exports=o,n.exports.firstLineError=u},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,i){var o=!1,r=function(t,e){this._reject(e)},a=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)},s=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},u=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(r){o||(o=!0,t.prototype._propagateFrom=i.propagateFromFunction(),t.prototype._boundValue=i.boundValueFunction());var l=n(r),c=new t(e);c._propagateFrom(this,1);var p=this._target();if(c._setBoundTo(l),l instanceof t){var d={promiseRejectionQueued:!1,promise:c,target:p,bindingPromise:l};p._then(e,a,void 0,c,d),l._then(s,u,void 0,c,d),c._setOnCancel(l)}else c._resolveCallback(p);return c},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=this._bitField&-2097153},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";function i(){try{Promise===r&&(Promise=o)}catch(t){}return r}var o;"undefined"!=typeof Promise&&(o=Promise);var r=t("./promise")();r.noConflict=i,e.exports=r},{"./promise":22}],5:[function(t,e,n){"use strict";var i=Object.create;if(i){var o=i(null),r=i(null);o[" size"]=r[" size"]=0}e.exports=function(e){function n(t,n){var i;if(null!=t&&(i=t[n]),"function"!=typeof i){var o="Object "+s.classString(t)+" has no method '"+s.toString(n)+"'";throw new e.TypeError(o)}return i}function i(t){var e=this.pop(),i=n(t,e);return i.apply(t,this)}function o(t){return t[this]}function r(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}var a,s=t("./util"),u=s.canEvaluate;s.isIdentifier;e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(i,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=r;else if(u){var i=a(t);e=null!==i?i:o}else e=o;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,i,o){var r=t("./util"),a=r.tryCatch,s=r.errorObj,u=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(r.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var i=a(t).call(this._boundValue());i===s&&(this._attachExtraTrace(i.e),u.throwLater(i.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){function n(t,n,s){return function(u){var l=s._boundValue();t:for(var c=0;c<t.length;++c){var p=t[c];if(p===Error||null!=p&&p.prototype instanceof Error){if(u instanceof p)return r(n).call(l,u)}else if("function"==typeof p){var d=r(p).call(l,u);if(d===a)return d;if(d)return r(n).call(l,u)}else if(i.isObject(u)){for(var f=o(p),h=0;h<f.length;++h){var y=f[h];if(p[y]!=u[y])continue t}return r(n).call(l,u)}}return e}}var i=t("./util"),o=t("./es5").keys,r=i.tryCatch,a=i.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(i())}function n(){if(o)return new e}function i(){var t=r.length-1;if(t>=0)return r[t]}var o=!1,r=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=r.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,r=t.prototype._popContext,a=t._peekContext,s=t.prototype._peekContext,u=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=r,t._peekContext=a,t.prototype._peekContext=s,t.prototype._promiseCreated=u,o=!1},o=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(e,n,i){"use strict";n.exports=function(n,i){function o(t,e){return{promise:e}}function r(){return!1}function a(t,e,n){var i=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+G.toString(t));i._attachCancellationCallback(t)})}catch(t){return t}}function s(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?G.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function u(){return this._onCancelField}function l(t){this._onCancelField=t}function c(){this._cancellationParent=void 0,this._onCancelField=void 0}function p(t,e){if(0!==(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function d(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function f(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t}function h(){this._trace=new I(this._peekContext())}function y(t,e){if(H(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var i=T(t);G.notEnumerableProp(t,"stack",i.message+"\n"+i.stack.join("\n")),G.notEnumerableProp(t,"__stackCleaned__",!0)}}}function _(t,e,n,i,o){if(void 0===t&&null!==e&&Q){if(void 0!==o&&o._returnedNonUndefined())return;if(0===(65535&i._bitField))return;n&&(n+=" ");var r="",a="";if(e._trace){for(var s=e._trace.stack.split("\n"),u=b(s),l=u.length-1;l>=0;--l){var c=u[l];if(!V.test(c)){var p=c.match(q);p&&(r="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(u.length>0)for(var d=u[0],l=0;l<s.length;++l)if(s[l]===d){l>0&&(a="\n"+s[l-1]);break}}var f="a promise was created in a "+n+"handler "+r+"but was not returned from it, see http://goo.gl/rRqMUw"+a;i._warn(f,!0,e)}}function v(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),m(n)}function m(t,e,i){if(at.warnings){var o,r=new B(t);if(e)i._attachExtraTrace(r);else if(at.longStackTraces&&(o=n._peekContext()))o.attachExtraTrace(r);else{var a=T(r);r.stack=a.message+"\n"+a.stack.join("\n")}et("warning",r)||k(r,"",!0)}}function g(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function x(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function w(t){for(var e=t[0],n=1;n<t.length;++n){for(var i=t[n],o=e.length-1,r=e[o],a=-1,s=i.length-1;s>=0;--s)if(i[s]===r){a=s;break}for(var s=a;s>=0;--s){var u=i[s];if(e[o]!==u)break;e.pop(),o--}e=i}}function b(t){for(var e=[],n=0;n<t.length;++n){var i=t[n],o="    (No stack trace)"===i||$.test(i),r=o&&it(i);o&&!r&&(z&&" "!==i.charAt(0)&&(i="    "+i),e.push(i))}return e}function C(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var i=e[n];if("    (No stack trace)"===i||$.test(i))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function T(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?C(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:b(e)}}function k(t,e,n){if("undefined"!=typeof console){var i;if(G.isObject(t)){var o=t.stack;i=e+U(o,t)}else i=e+String(t);"function"==typeof D?D(i,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(i)}}function E(t,e,n,i){var o=!1;try{"function"==typeof e&&(o=!0,"rejectionHandled"===t?e(i):e(n,i))}catch(t){N.throwLater(t)}"unhandledRejection"===t?et(t,n,i)||o||k(n,"Unhandled rejection "):et(t,i)}function A(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():G.toString(t);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var i=JSON.stringify(t);e=i}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+P(e)+">, no stack trace)"}function P(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function S(){return"function"==typeof rt}function F(t){var e=t.match(ot);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function j(t,e){if(S()){for(var n,i,o=t.stack.split("\n"),r=e.stack.split("\n"),a=-1,s=-1,u=0;u<o.length;++u){var l=F(o[u]);if(l){n=l.fileName,a=l.line;break}}for(var u=0;u<r.length;++u){var l=F(r[u]);if(l){i=l.fileName,s=l.line;break}}a<0||s<0||!n||!i||n!==i||a>=s||(it=function(t){if(L.test(t))return!0;var e=F(t);return!!(e&&e.fileName===n&&a<=e.line&&e.line<=s)})}}function I(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);rt(this,I),e>32&&this.uncycle()}var O,M,D,R=n._getDomain,N=n._async,B=e("./errors").Warning,G=e("./util"),H=G.canAttachTrace,L=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,V=/\((?:timers\.js):\d+:\d+\)/,q=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,$=null,U=null,z=!1,X=!(0==G.env("BLUEBIRD_DEBUG")),W=!(0==G.env("BLUEBIRD_WARNINGS")||!X&&!G.env("BLUEBIRD_WARNINGS")),Y=!(0==G.env("BLUEBIRD_LONG_STACK_TRACES")||!X&&!G.env("BLUEBIRD_LONG_STACK_TRACES")),Q=0!=G.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(W||!!G.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=t._bitField&-1048577|524288},n.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),N.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){E("rejectionHandled",O,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),E("unhandledRejection",M,t,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(t,e,n){return m(t,e,n||this)},n.onPossiblyUnhandledRejection=function(t){var e=R();M="function"==typeof t?null===e?t:G.domainBind(e,t):void 0},n.onUnhandledRejectionHandled=function(t){var e=R();O="function"==typeof t?null===e?t:G.domainBind(e,t):void 0};var Z=function(){};n.longStackTraces=function(){if(N.haveItemsQueued()&&!at.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!at.longStackTraces&&S()){var t=n.prototype._captureStackTrace,e=n.prototype._attachExtraTrace;at.longStackTraces=!0,Z=function(){if(N.haveItemsQueued()&&!at.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=t,n.prototype._attachExtraTrace=e,i.deactivateLongStackTraces(),N.enableTrampoline(),at.longStackTraces=!1},n.prototype._captureStackTrace=h,n.prototype._attachExtraTrace=y,i.activateLongStackTraces(),N.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return at.longStackTraces&&S()};var J=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return G.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!G.global.dispatchEvent(n)}}if("function"==typeof Event){var t=new Event("CustomEvent");return G.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!G.global.dispatchEvent(n)}}var t=document.createEvent("CustomEvent");return t.initCustomEvent("testingtheevent",!1,!0,{}),G.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!G.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),K=function(){return G.isNode?function(){return t.emit.apply(t,arguments)}:G.global?function(t){var e="on"+t.toLowerCase(),n=G.global[e];return!!n&&(n.apply(G.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),tt={promiseCreated:o,promiseFulfilled:o,promiseRejected:o,promiseResolved:o,promiseCancelled:o,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:o},et=function(t){var e=!1;try{e=K.apply(null,arguments)}catch(t){N.throwLater(t),e=!0}var n=!1;try{n=J(t,tt[t].apply(null,arguments))}catch(t){N.throwLater(t),n=!0}return n||e};n.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?n.longStackTraces():!t.longStackTraces&&n.hasLongStackTraces()&&Z()),"warnings"in t){var e=t.warnings;at.warnings=!!e,Q=at.warnings,G.isObject(e)&&"wForgottenReturn"in e&&(Q=!!e.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!at.cancellation){if(N.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=c,n.prototype._propagateFrom=p,n.prototype._onCancel=u,n.prototype._setOnCancel=l,n.prototype._attachCancellationCallback=s,n.prototype._execute=a,nt=p,at.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!at.monitoring?(at.monitoring=!0,n.prototype._fireEvent=et):!t.monitoring&&at.monitoring&&(at.monitoring=!1,n.prototype._fireEvent=r)),n},n.prototype._fireEvent=r,n.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(t){},n.prototype._attachCancellationCallback=function(t){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(t,e){};var nt=d,it=function(){return!1},ot=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;G.inherits(I,Error),i.CapturedTrace=I,I.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},i=0,o=this;void 0!==o;++i)e.push(o),o=o._parent;t=this._length=i;for(var i=t-1;i>=0;--i){var r=e[i].stack;void 0===n[r]&&(n[r]=i)}for(var i=0;i<t;++i){var a=e[i].stack,s=n[a];if(void 0!==s&&s!==i){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[i]._parent=void 0,e[i]._length=1;var u=i>0?e[i-1]:this;s<t-1?(u._parent=e[s+1],u._parent.uncycle(),u._length=u._parent._length+1):(u._parent=void 0,u._length=1);for(var l=u._length+1,c=i-2;c>=0;--c)e[c]._length=l,l++;return}}}},I.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=T(t),n=e.message,i=[e.stack],o=this;void 0!==o;)i.push(b(o.stack.split("\n"))),o=o._parent;w(i),x(i),G.notEnumerableProp(t,"stack",g(n,i)),G.notEnumerableProp(t,"__stackCleaned__",!0)}};var rt=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():A(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,$=t,U=e;var n=Error.captureStackTrace;return it=function(t){return L.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return $=/@/,U=e,z=!0,function(t){t.stack=(new Error).stack};var o;try{throw new Error}catch(t){o="stack"in t}return"stack"in i||!o||"number"!=typeof Error.stackTraceLimit?(U=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?A(e):e.toString()},null):($=t,U=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(D=function(t){console.warn(t)},G.isNode&&t.stderr.isTTY?D=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:G.isNode||"string"!=typeof(new Error).stack||(D=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var at={warnings:W,longStackTraces:!1,cancellation:!1,monitoring:!1};return Y&&n.longStackTraces(),{longStackTraces:function(){return at.longStackTraces},warnings:function(){return at.warnings},cancellation:function(){return at.cancellation},monitoring:function(){return at.monitoring},propagateFromFunction:function(){return nt},boundValueFunction:function(){return f},checkForgottenReturns:_,setBounds:j,warn:m,deprecated:v,CapturedTrace:I,fireDomEvent:J,fireGlobalEvent:K}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],i=function(){throw e};return this.caught(t,i)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var i=arguments[1];i instanceof t&&i.suppressUnhandledRejections();var o=function(){return i};return this.caught(n,o)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){function n(){return r(this)}function i(t,n){return o(t,n,e,e)}var o=t.reduce,r=t.all;t.prototype.each=function(t){return o(this,t,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return o(this,t,e,e)},t.each=function(t,i){return o(t,i,e,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=i}},{}],12:[function(t,e,n){"use strict";function i(t,e){function n(i){return this instanceof n?(p(this,"message","string"==typeof i?i:e),p(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(i)}return c(n,Error),n}function o(t){return this instanceof o?(p(this,"name","OperationalError"),p(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(p(this,"message",t.message),p(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new o(t)}var r,a,s=t("./es5"),u=s.freeze,l=t("./util"),c=l.inherits,p=l.notEnumerableProp,d=i("Warning","warning"),f=i("CancellationError","cancellation error"),h=i("TimeoutError","timeout error"),y=i("AggregateError","aggregate error");try{r=TypeError,a=RangeError}catch(t){r=i("TypeError","type error"),a=i("RangeError","range error")}for(var _="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<_.length;++v)"function"==typeof Array.prototype[_[v]]&&(y.prototype[_[v]]=Array.prototype[_[v]]);s.defineProperty(y.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),y.prototype.isOperational=!0;var m=0;y.prototype.toString=function(){var t=Array(4*m+1).join(" "),e="\n"+t+"AggregateError of:\n";m++,t=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",o=i.split("\n"),r=0;r<o.length;++r)o[r]=t+o[r];i=o.join("\n"),e+=i+"\n"}return m--,e},c(o,Error);var g=Error.__BluebirdErrorTypes__;g||(g=u({CancellationError:f,TimeoutError:h,OperationalError:o,RejectionError:o,AggregateError:y}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:a,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:d}},{"./es5":13,"./util":36}],13:[function(t,e,n){var i=function(){"use strict";return void 0===this}();if(i)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,r={}.toString,a={}.constructor.prototype,s=function(t){var e=[];for(var n in t)o.call(t,n)&&e.push(n);return e},u=function(t,e){return{value:t[e]}},l=function(t,e,n){return t[e]=n.value,t},c=function(t){return t},p=function(t){try{return Object(t).constructor.prototype}catch(t){return a}},d=function(t){try{return"[object Array]"===r.call(t)}catch(t){return!1}};e.exports={isArray:d,keys:s,names:s,defineProperty:l,getDescriptor:u,freeze:c,getPrototypeOf:p,isES5:i,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,i){return n(this,t,i,e)},t.filter=function(t,i,o){return n(t,i,o,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,i){function o(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function r(t){this.finallyHandler=t}function a(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function s(){return l.call(this,this.promise._target()._settledValue())}function u(t){if(!a(this,t))return d.e=t,d}function l(t){var o=this.promise,l=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?l.call(o._boundValue()):l.call(o._boundValue(),t);if(c===i)return c;if(void 0!==c){o._setReturnedNonUndefined();var f=n(c,o);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var h=new p("late cancellation observer");return o._attachExtraTrace(h),d.e=h,d}f.isPending()&&f._attachCancellationCallback(new r(this))}return f._then(s,u,void 0,this,void 0)}}}return o.isRejected()?(a(this),d.e=t,d):(a(this),t)}var c=t("./util"),p=e.CancellationError,d=c.errorObj,f=t("./catch_filter")(i);return o.prototype.isFinallyHandler=function(){return 0===this.type},r.prototype._resultCancelled=function(){a(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,i){return"function"!=typeof t?this.then():this._then(n,i,void 0,new o(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,l,l)},e.prototype.tap=function(t){return this._passThrough(t,1,l)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,l);var i,o=new Array(n-1),r=0;for(i=0;i<n-1;++i){var a=arguments[i];if(!c.isObject(a))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+c.classString(a)));o[r++]=a}o.length=r;var s=arguments[i];return this._passThrough(f(o,s,this),1,void 0,l)},o}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r,a){function s(t,n,i){for(var r=0;r<n.length;++r){i._pushContext();var a=f(n[r])(t);if(i._popContext(),a===d){i._pushContext();var s=e.reject(d.e);return i._popContext(),s}var u=o(a,i);if(u instanceof e)return u}return null}function u(t,n,o,r){if(a.cancellation()){var s=new e(i),u=this._finallyPromise=new e(i);this._promise=s.lastly(function(){return u}),s._captureStackTrace(),s._setOnCancel(this)}else{var l=this._promise=new e(i);l._captureStackTrace()}this._stack=r,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}var l=t("./errors"),c=l.TypeError,p=t("./util"),d=p.errorObj,f=p.tryCatch,h=[];p.inherits(u,r),u.prototype._isResolved=function(){return null===this._promise},u.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},u.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n="undefined"!=typeof this._generator.return;if(n)this._promise._pushContext(),t=f(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var i=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=i,
this._promise._attachExtraTrace(i),this._promise._pushContext(),t=f(this._generator.throw).call(this._generator,i),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},u.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=f(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},u.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=f(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},u.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},u.prototype.promise=function(){return this._promise},u.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},u.prototype._continue=function(t){var n=this._promise;if(t===d)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var i=t.value;if(t.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(i);var r=o(i,this._promise);if(!(r instanceof e)&&(r=s(r,this._yieldHandlers,this._promise),null===r))return void this._promiseRejected(new c("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(i))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r=r._target();var a=r._bitField;0===(50397184&a)?(this._yieldedPromise=r,r._proxy(this,null)):0!==(33554432&a)?e._async.invoke(this._promiseFulfilled,this,r._value()):0!==(16777216&a)?e._async.invoke(this._promiseRejected,this,r._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,i=u,o=(new Error).stack;return function(){var e=t.apply(this,arguments),r=new i(void 0,void 0,n,o),a=r.promise();return r._generator=e,r._promiseFulfilled(void 0),a}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new c("expecting a function but got "+p.classString(t));h.push(t)},e.spawn=function(t){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new u(t,this),o=i.promise();return i._run(e.spawn),o}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r,a){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj;e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var i}var o=[].slice.call(arguments);t&&o.pop();var i=new n(o).promise();return void 0!==t?i.spread(t):i}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r,a){function s(t,e,n,i){this.constructor$(t),this._promise._captureStackTrace();var o=l();this._callback=null===o?e:c.domainBind(o,e),this._preservedValues=i===r?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0)}function u(t,n,o,r){if("function"!=typeof n)return i("expecting a function but got "+c.classString(n));var a=0;if(void 0!==o){if("object"!=typeof o||null===o)return e.reject(new TypeError("options argument must be an object but it is "+c.classString(o)));if("number"!=typeof o.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(o.concurrency)));a=o.concurrency}return a="number"==typeof a&&isFinite(a)&&a>=1?a:0,new s(t,n,a,r).promise()}var l=e._getDomain,c=t("./util"),p=c.tryCatch,d=c.errorObj,f=e._async;c.inherits(s,n),s.prototype._asyncInit=function(){this._init$(void 0,-2)},s.prototype._init=function(){},s.prototype._promiseFulfilled=function(t,n){var i=this._values,r=this.length(),s=this._preservedValues,u=this._limit;if(n<0){if(n=n*-1-1,i[n]=t,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(u>=1&&this._inFlight>=u)return i[n]=t,this._queue.push(n),!1;null!==s&&(s[n]=t);var l=this._promise,c=this._callback,f=l._boundValue();l._pushContext();var h=p(c).call(f,t,n,r),y=l._popContext();if(a.checkForgottenReturns(h,y,null!==s?"Promise.filter":"Promise.map",l),h===d)return this._reject(h.e),!0;var _=o(h,this._promise);if(_ instanceof e){_=_._target();var v=_._bitField;if(0===(50397184&v))return u>=1&&this._inFlight++,i[n]=_,_._proxy(this,(n+1)*-1),!1;if(0===(33554432&v))return 0!==(16777216&v)?(this._reject(_._reason()),!0):(this._cancel(),!0);h=_._value()}i[n]=h}var m=++this._totalResolved;return m>=r&&(null!==s?this._filter(i,s):this._resolve(i),!0)},s.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var i=t.pop();this._promiseFulfilled(n[i],i)}},s.prototype._filter=function(t,e){for(var n=e.length,i=new Array(n),o=0,r=0;r<n;++r)t[r]&&(i[o++]=e[r]);i.length=o,this._resolve(i)},s.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return u(this,t,e,null)},e.map=function(t,e,n,i){return u(t,e,n,i)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r){var a=t("./util"),s=a.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+a.classString(t));return function(){var i=new e(n);i._captureStackTrace(),i._pushContext();var o=s(t).apply(this,arguments),a=i._popContext();return r.checkForgottenReturns(o,a,"Promise.method",i),i._resolveFromSyncValue(o),i}},e.attempt=e.try=function(t){if("function"!=typeof t)return o("expecting a function but got "+a.classString(t));var i=new e(n);i._captureStackTrace(),i._pushContext();var u;if(arguments.length>1){r.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],c=arguments[2];u=a.isArray(l)?s(t).apply(c,l):s(t).call(c,l)}else u=s(t)();var p=i._popContext();return r.checkForgottenReturns(u,p,"Promise.try",i),i._resolveFromSyncValue(u),i},e.prototype._resolveFromSyncValue=function(t){t===a.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";function i(t){return t instanceof Error&&c.getPrototypeOf(t)===Error.prototype}function o(t){var e;if(i(t)){e=new l(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var n=c.keys(t),o=0;o<n.length;++o){var r=n[o];p.test(r)||(e[r]=t[r])}return e}return a.markAsOriginatingFromRejection(t),t}function r(t,e){return function(n,i){if(null!==t){if(n){var r=o(s(n));t._attachExtraTrace(r),t._reject(r)}else if(e){var a=[].slice.call(arguments,1);t._fulfill(a)}else t._fulfill(i);t=null}}}var a=t("./util"),s=a.maybeWrapAsError,u=t("./errors"),l=u.OperationalError,c=t("./es5"),p=/^(?:name|message|stack|cause)$/;e.exports=r},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!r.isArray(t))return i.call(n,t,e);var o=s(e).apply(n._boundValue(),[null].concat(t));o===u&&a.throwLater(o.e)}function i(t,e){var n=this,i=n._boundValue(),o=void 0===t?s(e).call(i,null):s(e).call(i,null,t);o===u&&a.throwLater(o.e)}function o(t,e){var n=this;if(!t){var i=new Error(t+"");i.cause=t,t=i}var o=s(e).call(n._boundValue(),t);o===u&&a.throwLater(o.e)}var r=t("./util"),a=e._async,s=r.tryCatch,u=r.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var r=i;void 0!==e&&Object(e).spread&&(r=n),this._then(r,o,void 0,this,t)}return this}}},{"./util":36}],22:[function(e,n,i){"use strict";n.exports=function(){function i(){}function o(t,e){if(null==t||t.constructor!==r)throw new g("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new g("expecting a function but got "+h.classString(e))}function r(t){t!==w&&o(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function a(t){this.promise._resolveCallback(t)}function s(t){this.promise._rejectCallback(t,!1)}function u(t){var e=new r(w);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var l,c=function(){return new g("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},p=function(){return new r.PromiseInspection(this._target())},d=function(t){return r.reject(new g(t))},f={},h=e("./util");l=h.isNode?function(){var e=t.domain;return void 0===e&&(e=null),e}:function(){return null},h.notEnumerableProp(r,"_getDomain",l);var y=e("./es5"),_=e("./async"),v=new _;y.defineProperty(r,"_async",{value:v});var m=e("./errors"),g=r.TypeError=m.TypeError;r.RangeError=m.RangeError;var x=r.CancellationError=m.CancellationError;r.TimeoutError=m.TimeoutError,r.OperationalError=m.OperationalError,r.RejectionError=m.OperationalError,r.AggregateError=m.AggregateError;var w=function(){},b={},C={},T=e("./thenables")(r,w),k=e("./promise_array")(r,w,T,d,i),E=e("./context")(r),A=E.create,P=e("./debuggability")(r,E),S=(P.CapturedTrace,e("./finally")(r,T,C)),F=e("./catch_filter")(C),j=e("./nodeback"),I=h.errorObj,O=h.tryCatch;return r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,i=new Array(e-1),o=0;for(n=0;n<e-1;++n){var r=arguments[n];if(!h.isObject(r))return d("Catch statement predicate: expecting an object but got "+h.classString(r));i[o++]=r}return i.length=o,t=arguments[n],this.then(void 0,F(i,t,this))}return this.then(void 0,t)},r.prototype.reflect=function(){return this._then(p,p,void 0,this,void 0)},r.prototype.then=function(t,e){if(P.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+h.classString(t);arguments.length>1&&(n+=", "+h.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},r.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},r.prototype.spread=function(t){return"function"!=typeof t?d("expecting a function but got "+h.classString(t)):this.all()._then(t,void 0,void 0,b,void 0)},r.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},r.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new k(this).promise()},r.prototype.error=function(t){return this.caught(h.originatesFromRejection,t)},r.getNewLibraryCopy=n.exports,r.is=function(t){return t instanceof r},r.fromNode=r.fromCallback=function(t){var e=new r(w);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=O(t)(j(e,n));return i===I&&e._rejectCallback(i.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},r.all=function(t){return new k(t).promise()},r.cast=function(t){var e=T(t);return e instanceof r||(e=new r(w),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},r.resolve=r.fulfilled=r.cast,r.reject=r.rejected=function(t){var e=new r(w);return e._captureStackTrace(),e._rejectCallback(t,!0),e},r.setScheduler=function(t){if("function"!=typeof t)throw new g("expecting a function but got "+h.classString(t));return v.setScheduler(t)},r.prototype._then=function(t,e,n,i,o){var a=void 0!==o,s=a?o:new r(w),u=this._target(),c=u._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===i&&0!==(2097152&this._bitField)&&(i=0!==(50397184&c)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var p=l();if(0!==(50397184&c)){var d,f,y=u._settlePromiseCtx;0!==(33554432&c)?(f=u._rejectionHandler0,d=t):0!==(16777216&c)?(f=u._fulfillmentHandler0,d=e,u._unsetRejectionIsUnhandled()):(y=u._settlePromiseLateCancellationObserver,f=new x("late cancellation observer"),u._attachExtraTrace(f),d=e),v.invoke(y,u,{handler:null===p?d:"function"==typeof d&&h.domainBind(p,d),promise:s,receiver:i,value:f})}else u._addCallbacks(t,e,s,i,p);return s},r.prototype._length=function(){return 65535&this._bitField},r.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},r.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},r.prototype._setLength=function(t){this._bitField=this._bitField&-65536|65535&t},r.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},r.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},r.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},r.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},r.prototype._isFinal=function(){return(4194304&this._bitField)>0},r.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},r.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},r.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},r.prototype._setAsyncGuaranteed=function(){v.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},r.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==f)return void 0===e&&this._isBound()?this._boundValue():e},r.prototype._promiseAt=function(t){return this[4*t-4+2]},r.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},r.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},r.prototype._boundValue=function(){},r.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,i=t._promise0,o=t._receiverAt(0);void 0===o&&(o=f),this._addCallbacks(e,n,i,o,null)},r.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),i=t._rejectionHandlerAt(e),o=t._promiseAt(e),r=t._receiverAt(e);void 0===r&&(r=f),this._addCallbacks(n,i,o,r,null)},r.prototype._addCallbacks=function(t,e,n,i,o){var r=this._length();if(r>=65531&&(r=0,this._setLength(0)),0===r)this._promise0=n,this._receiver0=i,"function"==typeof t&&(this._fulfillmentHandler0=null===o?t:h.domainBind(o,t)),"function"==typeof e&&(this._rejectionHandler0=null===o?e:h.domainBind(o,e));else{var a=4*r-4;this[a+2]=n,this[a+3]=i,"function"==typeof t&&(this[a+0]=null===o?t:h.domainBind(o,t)),"function"==typeof e&&(this[a+1]=null===o?e:h.domainBind(o,e))}return this._setLength(r+1),r},r.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},r.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=T(t,this);if(!(n instanceof r))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target();if(i===this)return void this._reject(c());var o=i._bitField;if(0===(50397184&o)){var a=this._length();a>0&&i._migrateCallback0(this);for(var s=1;s<a;++s)i._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!==(33554432&o))this._fulfill(i._value());else if(0!==(16777216&o))this._reject(i._reason());else{var u=new x("late cancellation observer");i._attachExtraTrace(u),this._reject(u)}}},r.prototype._rejectCallback=function(t,e,n){var i=h.ensureErrorObject(t),o=i===t;if(!o&&!n&&P.warnings()){var r="a promise was rejected with a non-error: "+h.classString(t);this._warn(r,!0)}this._attachExtraTrace(i,!!e&&o),this._reject(t)},r.prototype._resolveFromExecutor=function(t){if(t!==w){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==i&&e._rejectCallback(i,!0)}},r.prototype._settlePromiseFromHandler=function(t,e,n,i){var o=i._bitField;if(0===(65536&o)){i._pushContext();var r;e===b?n&&"number"==typeof n.length?r=O(t).apply(this._boundValue(),n):(r=I,r.e=new g("cannot .spread() a non-array: "+h.classString(n))):r=O(t).call(e,n);var a=i._popContext();o=i._bitField,0===(65536&o)&&(r===C?i._reject(n):r===I?i._rejectCallback(r.e,!1):(P.checkForgottenReturns(r,a,"",i,this),i._resolveCallback(r)))}},r.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},r.prototype._followee=function(){return this._rejectionHandler0},r.prototype._setFollowee=function(t){this._rejectionHandler0=t},r.prototype._settlePromise=function(t,e,n,o){var a=t instanceof r,s=this._bitField,u=0!==(134217728&s);0!==(65536&s)?(a&&t._invokeInternalOnCancel(),n instanceof S&&n.isFinallyHandler()?(n.cancelPromise=t,O(e).call(n,o)===I&&t._reject(I.e)):e===p?t._fulfill(p.call(n)):n instanceof i?n._promiseCancelled(t):a||t instanceof k?t._cancel():n.cancel()):"function"==typeof e?a?(u&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,o,t)):e.call(n,o,t):n instanceof i?n._isResolved()||(0!==(33554432&s)?n._promiseFulfilled(o,t):n._promiseRejected(o,t)):a&&(u&&t._setAsyncGuaranteed(),0!==(33554432&s)?t._fulfill(o):t._reject(o))},r.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,i=t.receiver,o=t.value;"function"==typeof e?n instanceof r?this._settlePromiseFromHandler(e,i,o,n):e.call(i,o,n):n instanceof r&&n._reject(o)},r.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},r.prototype._settlePromise0=function(t,e,n){var i=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,t,o,e)},r.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},r.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():v.settlePromises(this))}},r.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?v.fatalError(t,h.isNode):void((65535&e)>0?v.settlePromises(this):this._ensurePossibleRejectionHandled())},r.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var i=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),r=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,r,e)}},r.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var i=this._rejectionHandlerAt(n),o=this._promiseAt(n),r=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,r,e)}},r.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,t),this._fulfillPromises(e,i)}this._setLength(0)}this._clearCancellationData()},r.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},r.defer=r.pending=function(){P.deprecated("Promise.defer","new Promise");var t=new r(w);return{promise:t,resolve:a,reject:s}},h.notEnumerableProp(r,"_makeSelfResolutionError",c),e("./method")(r,w,T,d,P),e("./bind")(r,w,T,P),e("./cancel")(r,k,d,P),e("./direct_resolve")(r),e("./synchronous_inspection")(r),e("./join")(r,k,T,w,v,l),r.Promise=r,r.version="3.5.0",e("./map.js")(r,k,d,T,w,P),e("./call_get.js")(r),e("./using.js")(r,d,T,A,w,P),e("./timers.js")(r,w,P),e("./generators.js")(r,d,w,T,i,P),e("./nodeify.js")(r),e("./promisify.js")(r,w),e("./props.js")(r,k,T,d),e("./race.js")(r,w,T,d),e("./reduce.js")(r,k,d,T,w,P),e("./settle.js")(r,k,P),e("./some.js")(r,k,d),e("./filter.js")(r,w),e("./each.js")(r,w),e("./any.js")(r),h.toFastProperties(r),h.toFastProperties(r.prototype),u({a:1}),u({b:2}),u({c:3}),u(1),u(function(){}),u(void 0),u(!1),u(new r(w)),P.setBounds(_.firstLineError,h.lastLineError),r}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r){function a(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function s(t){var i=this._promise=new e(n);t instanceof e&&i._propagateFrom(t,3),i._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var u=t("./util");u.isArray;return u.inherits(s,r),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function t(n,r){var s=i(this._values,this._promise);if(s instanceof e){s=s._target();var l=s._bitField;if(this._values=s,0===(50397184&l))return this._promise._setAsyncGuaranteed(),s._then(t,this._reject,void 0,this,r);if(0===(33554432&l))return 0!==(16777216&l)?this._reject(s._reason()):this._cancel();s=s._value()}if(s=u.asArray(s),null===s){var c=o("expecting an array or an iterable object but got "+u.classString(s)).reason();return void this._promise._rejectCallback(c,!1)}return 0===s.length?void(r===-5?this._resolveEmptyArray():this._resolve(a(r))):void this._iterate(s)},s.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,r=!1,a=null,s=0;s<n;++s){var u=i(t[s],o);u instanceof e?(u=u._target(),a=u._bitField):a=null,r?null!==a&&u.suppressUnhandledRejections():null!==a?0===(50397184&a)?(u._proxy(this,s),this._values[s]=u):r=0!==(33554432&a)?this._promiseFulfilled(u._value(),s):0!==(16777216&a)?this._promiseRejected(u._reason(),s):this._promiseCancelled(s):r=this._promiseFulfilled(u,s)}r||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},s.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(t){return t},s}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){function i(t){return!b.test(t)}function o(t){try{return t.__isPromisified__===!0}catch(t){return!1}}function r(t,e,n){var i=f.getDataPropertyOrDefault(t,e+n,x);return!!i&&o(i)}function a(t,e,n){for(var i=0;i<t.length;i+=2){var o=t[i];if(n.test(o))for(var r=o.replace(n,""),a=0;a<t.length;a+=2)if(t[a]===r)throw new m("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function s(t,e,n,i){for(var s=f.inheritedDataKeys(t),u=[],l=0;l<s.length;++l){var c=s[l],p=t[c],d=i===C||C(c,p,t);"function"!=typeof p||o(p)||r(t,c,e)||!i(c,p,t,d)||u.push(c,p)}return a(u,e,n),u}function u(t,i,o,r,a,s){function u(){var o=i;i===d&&(o=this);var r=new e(n);r._captureStackTrace();var a="string"==typeof c&&this!==l?this[c]:t,u=h(r,s);try{a.apply(o,y(arguments,u))}catch(t){r._rejectCallback(_(t),!0,!0)}return r._isFateSealed()||r._setAsyncGuaranteed(),r}var l=function(){return this}(),c=t;return"string"==typeof c&&(t=r),f.notEnumerableProp(u,"__isPromisified__",!0),u}function l(t,e,n,i,o){for(var r=new RegExp(T(e)+"$"),a=s(t,e,r,n),u=0,l=a.length;u<l;u+=2){var c=a[u],p=a[u+1],h=c+e;if(i===k)t[h]=k(c,d,c,p,e,o);else{var y=i(p,function(){return k(c,d,c,p,e,o)});f.notEnumerableProp(y,"__isPromisified__",!0),t[h]=y}}return f.toFastProperties(t),t}function c(t,e,n){return k(t,e,void 0,t,null,n)}var p,d={},f=t("./util"),h=t("./nodeback"),y=f.withAppended,_=f.maybeWrapAsError,v=f.canEvaluate,m=t("./errors").TypeError,g="Async",x={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],b=new RegExp("^(?:"+w.join("|")+")$"),C=function(t){return f.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},T=function(t){return t.replace(/([$])/,"\\$")},k=v?p:u;e.promisify=function(t,e){if("function"!=typeof t)throw new m("expecting a function but got "+f.classString(t));if(o(t))return t;e=Object(e);var n=void 0===e.context?d:e.context,r=!!e.multiArgs,a=c(t,n,r);return f.copyDescriptors(t,a,i),a},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new m("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,i=e.suffix;"string"!=typeof i&&(i=g);var o=e.filter;"function"!=typeof o&&(o=C);var r=e.promisifier;if("function"!=typeof r&&(r=k),!f.isIdentifier(i))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=f.inheritedDataKeys(t),s=0;s<a.length;++s){var u=t[a[s]];"constructor"!==a[s]&&f.isClass(u)&&(l(u.prototype,i,o,r,n),l(u,i,o,r,n))}return l(t,i,o,r,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,i,o){function r(t){var e,n=!1;if(void 0!==s&&t instanceof s)e=p(t),n=!0;else{var i=c.keys(t),o=i.length;e=new Array(2*o);for(var r=0;r<o;++r){var a=i[r];e[r]=t[a],e[r+o]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function a(t){var n,a=i(t);return l(a)?(n=a instanceof e?a._then(e.props,void 0,void 0,void 0,void 0):new r(a).promise(),a instanceof e&&n._propagateFrom(a,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,u=t("./util"),l=u.isObject,c=t("./es5");"function"==typeof Map&&(s=Map);var p=function(){function t(t,i){this[e]=t,this[e+n]=i,e++}var e=0,n=0;return function(i){n=i.size,e=0;var o=new Array(2*i.size);return i.forEach(t,o),o}}(),d=function(t){for(var e=new s,n=t.length/2|0,i=0;i<n;++i){var o=t[n+i],r=t[i];e.set(o,r)}return e};u.inherits(r,n),r.prototype._init=function(){},r.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var i;if(this._isMap)i=d(this._values);else{i={};for(var o=this.length(),r=0,a=this.length();r<a;++r)i[this._values[r+o]]=this._values[r]}return this._resolve(i),!0}return!1},r.prototype.shouldCopyValues=function(){return!1},r.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return a(this)},e.props=function(t){return a(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function i(t,e,n,i,o){for(var r=0;r<o;++r)n[r+i]=t[r+e],t[r+e]=void 0}function o(t){this._capacity=t,this._length=0,this._front=0}o.prototype._willBeOverCapacity=function(t){return this._capacity<t},o.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},o.prototype.push=function(t,e,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var o=this._front+i-3;this._checkCapacity(i);var r=this._capacity-1;this[o+0&r]=t,this[o+1&r]=e,this[o+2&r]=n,this._length=i},o.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},o.prototype.length=function(){return this._length},o.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},o.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,o=this._length,r=n+o&e-1;i(this,0,this,e,r)},e.exports=o},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,i,o){function r(t,r){var u=i(t);if(u instanceof e)return s(u);if(t=a.asArray(t),null===t)return o("expecting an array or an iterable object but got "+a.classString(t));var l=new e(n);void 0!==r&&l._propagateFrom(r,3);for(var c=l._fulfill,p=l._reject,d=0,f=t.length;d<f;++d){var h=t[d];(void 0!==h||d in t)&&e.cast(h)._then(c,p,void 0,l,null)}return l}var a=t("./util"),s=function(t){return t.then(function(e){return r(e,t)})};e.race=function(t){return r(t,void 0)},e.prototype.race=function(){return r(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r,a){function s(t,n,i,o){this.constructor$(t);var a=d();this._fn=null===a?n:f.domainBind(a,n),void 0!==i&&(i=e.resolve(i),i._attachCancellationCallback(this)),this._initialValue=i,this._currentCancellable=null,o===r?this._eachValues=Array(this._length):0===o?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function u(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function l(t,e,n,o){if("function"!=typeof e)return i("expecting a function but got "+f.classString(e));var r=new s(t,e,n,o);return r.promise()}function c(t){this.accum=t,this.array._gotAccum(t);var n=o(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(p,void 0,void 0,this,void 0)):p.call(this,n)}function p(t){var n=this.array,i=n._promise,o=h(n._fn);i._pushContext();var r;r=void 0!==n._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length),r instanceof e&&(n._currentCancellable=r);var s=i._popContext();return a.checkForgottenReturns(r,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),r}var d=e._getDomain,f=t("./util"),h=f.tryCatch;f.inherits(s,n),s.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==r&&this._eachValues.push(t)},s.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},s.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},s.prototype._iterate=function(t){this._values=t;var n,i,o=t.length;if(void 0!==this._initialValue?(n=this._initialValue,i=0):(n=e.resolve(t[0]),i=1),this._currentCancellable=n,!n.isRejected())for(;i<o;++i){var r={accum:null,value:t[i],index:i,length:o,array:this};n=n._then(c,void 0,void 0,r,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(u,u,void 0,n,this)},e.prototype.reduce=function(t,e){return l(this,t,e,null)},e.reduce=function(t,e,n,i){return l(t,e,n,i)}}},{"./util":36}],29:[function(e,n,o){"use strict";var r,a=e("./util"),s=function(){
throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},u=a.getNativePromise();if(a.isNode&&"undefined"==typeof MutationObserver){var l=i.setImmediate,c=t.nextTick;r=a.isRecentNode?function(t){l.call(i,t)}:function(e){c.call(t,e)}}else if("function"==typeof u&&"function"==typeof u.resolve){var p=u.resolve();r=function(t){p.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:s:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,i=document.createElement("div"),o=new MutationObserver(function(){t.classList.toggle("foo"),n=!1});o.observe(i,e);var r=function(){n||(n=!0,i.classList.toggle("foo"))};return function(n){var i=new MutationObserver(function(){i.disconnect(),n()});i.observe(t,e),r()}}();n.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,i){function o(t){this.constructor$(t)}var r=e.PromiseInspection,a=t("./util");a.inherits(o,n),o.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(t,e){var n=new r;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},o.prototype._promiseRejected=function(t,e){var n=new r;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return i.deprecated(".settle()",".reflect()"),new o(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,i){function o(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function r(t,e){if((0|e)!==e||e<0)return i("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new o(t),r=n.promise();return n.setHowMany(e),n.init(),r}var a=t("./util"),s=t("./errors").RangeError,u=t("./errors").AggregateError,l=a.isArray,c={};a.inherits(o,n),o.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=l(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},o.prototype.init=function(){this._initialized=!0,this._init()},o.prototype.setUnwrap=function(){this._unwrap=!0},o.prototype.howMany=function(){return this._howMany},o.prototype.setHowMany=function(t){this._howMany=t},o.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},o.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},o.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},o.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new u,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},o.prototype._fulfilled=function(){return this._totalResolved},o.prototype._rejected=function(){return this._values.length-this.length()},o.prototype._addRejected=function(t){this._values.push(t)},o.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},o.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},o.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new s(e)},o.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return r(t,e)},e.prototype.some=function(t){return r(this,t)},e._SomePromiseArray=o}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},r=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return r.call(this._target())},t.prototype.isFulfilled=function(){return o.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),i.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){function i(t,i){if(c(t)){if(t instanceof e)return t;var o=r(t);if(o===l){i&&i._pushContext();var u=e.reject(o.e);return i&&i._popContext(),u}if("function"==typeof o){if(a(t)){var u=new e(n);return t._then(u._fulfill,u._reject,void 0,u,null),u}return s(t,o,i)}}return t}function o(t){return t.then}function r(t){try{return o(t)}catch(t){return l.e=t,l}}function a(t){try{return p.call(t,"_promise0")}catch(t){return!1}}function s(t,i,o){function r(t){s&&(s._resolveCallback(t),s=null)}function a(t){s&&(s._rejectCallback(t,p,!0),s=null)}var s=new e(n),c=s;o&&o._pushContext(),s._captureStackTrace(),o&&o._popContext();var p=!0,d=u.tryCatch(i).call(t,r,a);return p=!1,s&&d===l&&(s._rejectCallback(d.e,!0,!0),s=null),c}var u=t("./util"),l=u.errorObj,c=u.isObject,p={}.hasOwnProperty;return i}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,i){function o(t){this.handle=t}function r(t){return clearTimeout(this.handle),t}function a(t){throw clearTimeout(this.handle),t}var s=t("./util"),u=e.TimeoutError;o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var l=function(t){return c(+this).thenReturn(t)},c=e.delay=function(t,r){var a,s;return void 0!==r?(a=e.resolve(r)._then(l,null,null,t,void 0),i.cancellation()&&r instanceof e&&a._setOnCancel(r)):(a=new e(n),s=setTimeout(function(){a._fulfill()},+t),i.cancellation()&&a._setOnCancel(new o(s)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};e.prototype.delay=function(t){return c(t,this)};var p=function(t,e,n){var i;i="string"!=typeof e?e instanceof Error?e:new u("operation timed out"):new u(e),s.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._reject(i),null!=n&&n.cancel()};e.prototype.timeout=function(t,e){t=+t;var n,s,u=new o(setTimeout(function(){n.isPending()&&p(n,e,s)},t));return i.cancellation()?(s=this.then(),n=s._then(r,a,void 0,u,void 0),n._setOnCancel(u)):n=this._then(r,a,void 0,u,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,r,a){function s(t){setTimeout(function(){throw t},0)}function u(t){var e=i(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function l(t,n){function o(){if(a>=l)return c._fulfill();var r=u(t[a++]);if(r instanceof e&&r._isDisposable()){try{r=i(r._getDisposer().tryDispose(n),t.promise)}catch(t){return s(t)}if(r instanceof e)return r._then(o,s,null,null,null)}o()}var a=0,l=t.length,c=new e(r);return o(),c}function c(t,e,n){this._data=t,this._promise=e,this._context=n}function p(t,e,n){this.constructor$(t,e,n)}function d(t){return c.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function f(t){this.length=t,this.promise=null,this[t-1]=null}var h=t("./util"),y=t("./errors").TypeError,_=t("./util").inherits,v=h.errorObj,m=h.tryCatch,g={};c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():g},c.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=e!==g?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},c.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},_(p,c),p.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},f.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var i=this[n];i instanceof e&&i.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var o=arguments[t-1];if("function"!=typeof o)return n("expecting a function but got "+h.classString(o));var r,s=!0;2===t&&Array.isArray(arguments[0])?(r=arguments[0],t=r.length,s=!1):(r=arguments,t--);for(var u=new f(t),p=0;p<t;++p){var y=r[p];if(c.isDisposer(y)){var _=y;y=y.promise(),y._setDisposable(_)}else{var g=i(y);g instanceof e&&(y=g._then(d,null,null,{resources:u,index:p},void 0))}u[p]=y}for(var x=new Array(u.length),p=0;p<x.length;++p)x[p]=e.resolve(u[p]).reflect();var w=e.all(x).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return v.e=n.error(),v;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}b._pushContext(),o=m(o);var i=s?o.apply(void 0,t):o(t),r=b._popContext();return a.checkForgottenReturns(i,r,"Promise.using",b),i}),b=w.lastly(function(){var t=new e.PromiseInspection(w);return l(u,t)});return u.promise=b,b._setOnCancel(u),b},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new p(t,this,o());throw new y}}},{"./errors":12,"./util":36}],36:[function(e,n,o){"use strict";function r(){try{var t=j;return j=null,t.apply(this,arguments)}catch(t){return F.e=t,F}}function a(t){return j=t,r}function s(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function u(t){return"function"==typeof t||"object"==typeof t&&null!==t}function l(t){return s(t)?new Error(m(t)):t}function c(t,e){var n,i=t.length,o=new Array(i+1);for(n=0;n<i;++n)o[n]=t[n];return o[n]=e,o}function p(t,e,n){if(!P.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function d(t,e,n){if(s(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return P.defineProperty(t,e,i),t}function f(t){throw t}function h(t){try{if("function"==typeof t){var e=P.names(t.prototype),n=P.isES5&&e.length>1,i=e.length>0&&!(1===e.length&&"constructor"===e[0]),o=D.test(t+"")&&P.names(t).length>0;if(n||i||o)return!0}return!1}catch(t){return!1}}function y(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}function _(t){return R.test(t)}function v(t,e,n){for(var i=new Array(t),o=0;o<t;++o)i[o]=e+o+n;return i}function m(t){try{return t+""}catch(t){return"[no string representation]"}}function g(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function x(t){try{d(t,"isOperational",!0)}catch(t){}}function w(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0)}function b(t){return g(t)&&P.propertyIsWritable(t,"stack")}function C(t){return{}.toString.call(t)}function T(t,e,n){for(var i=P.names(t),o=0;o<i.length;++o){var r=i[o];if(n(r))try{P.defineProperty(e,r,P.getDescriptor(t,r))}catch(t){}}}function k(e){return L?t.env[e]:void 0}function E(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function A(t,e){return t.bind(e)}var P=e("./es5"),S="undefined"==typeof navigator,F={e:{}},j,I="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof i?i:void 0!==this?this:null,O=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)i.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var i={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},M=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(P.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var i=[],o=Object.create(null);null!=t&&!e(t);){var r;try{r=n(t)}catch(t){return i}for(var a=0;a<r.length;++a){var s=r[a];if(!o[s]){o[s]=!0;var u=Object.getOwnPropertyDescriptor(t,s);null!=u&&null==u.get&&null==u.set&&i.push(s)}}t=P.getPrototypeOf(t)}return i}}var i={}.hasOwnProperty;return function(n){if(e(n))return[];var o=[];t:for(var r in n)if(i.call(n,r))o.push(r);else{for(var a=0;a<t.length;++a)if(i.call(t[a],r))continue t;o.push(r)}return o}}(),D=/this\s*\.\s*\S+\s*=/,R=/^[a-z$_][a-z$_0-9]*$/i,N=function(){return"stack"in new Error?function(t){return b(t)?t:new Error(m(t))}:function(t){if(b(t))return t;try{throw new Error(m(t))}catch(t){return t}}}(),B=function(t){return P.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var G="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],i=t[Symbol.iterator]();!(e=i.next()).done;)n.push(e.value);return n};B=function(t){return P.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?G(t):null}}var H="undefined"!=typeof t&&"[object process]"===C(t).toLowerCase(),L="undefined"!=typeof t&&"undefined"!=typeof t.env,V={isClass:h,isIdentifier:_,inheritedDataKeys:M,getDataPropertyOrDefault:p,thrower:f,isArray:P.isArray,asArray:B,notEnumerableProp:d,isPrimitive:s,isObject:u,isError:g,canEvaluate:S,errorObj:F,tryCatch:a,inherits:O,withAppended:c,maybeWrapAsError:l,toFastProperties:y,filledRange:v,toString:m,canAttachTrace:b,ensureErrorObject:N,originatesFromRejection:w,markAsOriginatingFromRejection:x,classString:C,copyDescriptors:T,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:H,hasEnvVariables:L,env:k,global:I,getNativePromise:E,domainBind:A};V.isRecentNode=V.isNode&&function(){var e=t.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),V.isNode&&V.toFastProperties(t);try{throw new Error}catch(t){V.lastLineError=t}n.exports=V},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:5}],3:[function(t,e,n){!function(t,n,i,o){"use strict";function r(t,e,n){return setTimeout(c(t,n),e)}function a(t,e,n){return!!Array.isArray(t)&&(s(t,n[e],n),!0)}function s(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==o)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function u(e,n,i){var o="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=t.console&&(t.console.warn||t.console.log);return r&&r.call(t.console,o,i),e.apply(this,arguments)}}function l(t,e,n){var i,o=e.prototype;i=t.prototype=Object.create(o),i.constructor=t,i._super=o,n&&dt(i,n)}function c(t,e){return function(){return t.apply(e,arguments)}}function p(t,e){return typeof t==yt?t.apply(e?e[0]||o:o,e):t}function d(t,e){return t===o?e:t}function f(t,e,n){s(v(e),function(e){t.addEventListener(e,n,!1)})}function h(t,e,n){s(v(e),function(e){t.removeEventListener(e,n,!1)})}function y(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function _(t,e){return t.indexOf(e)>-1}function v(t){return t.trim().split(/\s+/g)}function m(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function g(t){return Array.prototype.slice.call(t,0)}function x(t,e,n){for(var i=[],o=[],r=0;r<t.length;){var a=e?t[r][e]:t[r];m(o,a)<0&&i.push(t[r]),o[r]=a,r++}return n&&(i=e?i.sort(function(t,n){return t[e]>n[e]}):i.sort()),i}function w(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),a=0;a<ft.length;){if(n=ft[a],i=n?n+r:e,i in t)return i;a++}return o}function b(){return wt++}function C(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}function T(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){p(t.options.enable,[t])&&n.handler(e)},this.init()}function k(t){var e,n=t.options.inputClass;return new(e=n?n:Tt?G:kt?V:Ct?$:B)(t,E)}function E(t,e,n){var i=n.pointers.length,o=n.changedPointers.length,r=e&jt&&i-o===0,a=e&(Ot|Mt)&&i-o===0;n.isFirst=!!r,n.isFinal=!!a,r&&(t.session={}),n.eventType=e,A(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function A(t,e){var n=t.session,i=e.pointers,o=i.length;n.firstInput||(n.firstInput=F(e)),o>1&&!n.firstMultiple?n.firstMultiple=F(e):1===o&&(n.firstMultiple=!1);var r=n.firstInput,a=n.firstMultiple,s=a?a.center:r.center,u=e.center=j(i);e.timeStamp=mt(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=D(s,u),e.distance=M(s,u),P(n,e),e.offsetDirection=O(e.deltaX,e.deltaY);var l=I(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=vt(l.x)>vt(l.y)?l.x:l.y,e.scale=a?N(a.pointers,i):1,e.rotation=a?R(a.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,S(n,e);var c=t.element;y(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function P(t,e){var n=e.center,i=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};e.eventType!==jt&&r.eventType!==Ot||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=o.x+(n.x-i.x),e.deltaY=o.y+(n.y-i.y)}function S(t,e){var n,i,r,a,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(e.eventType!=Mt&&(u>Ft||s.velocity===o)){var l=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,p=I(u,l,c);i=p.x,r=p.y,n=vt(p.x)>vt(p.y)?p.x:p.y,a=O(l,c),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,a=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=a}function F(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:_t(t.pointers[n].clientX),clientY:_t(t.pointers[n].clientY)},n++;return{timeStamp:mt(),pointers:e,center:j(e),deltaX:t.deltaX,deltaY:t.deltaY}}function j(t){var e=t.length;if(1===e)return{x:_t(t[0].clientX),y:_t(t[0].clientY)};for(var n=0,i=0,o=0;o<e;)n+=t[o].clientX,i+=t[o].clientY,o++;return{x:_t(n/e),y:_t(i/e)}}function I(t,e,n){return{x:e/t||0,y:n/t||0}}function O(t,e){return t===e?Dt:vt(t)>=vt(e)?t<0?Rt:Nt:e<0?Bt:Gt}function M(t,e,n){n||(n=qt);var i=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return Math.sqrt(i*i+o*o)}function D(t,e,n){n||(n=qt);var i=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return 180*Math.atan2(o,i)/Math.PI}function R(t,e){return D(e[1],e[0],$t)+D(t[1],t[0],$t)}function N(t,e){return M(e[0],e[1],$t)/M(t[0],t[1],$t)}function B(){this.evEl=zt,this.evWin=Xt,this.pressed=!1,T.apply(this,arguments)}function G(){this.evEl=Qt,this.evWin=Zt,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function H(){this.evTarget=Kt,this.evWin=te,this.started=!1,T.apply(this,arguments)}function L(t,e){var n=g(t.touches),i=g(t.changedTouches);return e&(Ot|Mt)&&(n=x(n.concat(i),"identifier",!0)),[n,i]}function V(){this.evTarget=ne,this.targetIds={},T.apply(this,arguments)}function q(t,e){var n=g(t.touches),i=this.targetIds;if(e&(jt|It)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,r,a=g(t.changedTouches),s=[],u=this.target;if(r=n.filter(function(t){return y(t.target,u)}),e===jt)for(o=0;o<r.length;)i[r[o].identifier]=!0,o++;for(o=0;o<a.length;)i[a[o].identifier]&&s.push(a[o]),e&(Ot|Mt)&&delete i[a[o].identifier],o++;return s.length?[x(r.concat(s),"identifier",!0),s]:void 0}function $(){T.apply(this,arguments);var t=c(this.handler,this);this.touch=new V(this.manager,t),this.mouse=new B(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function U(t,e){t&jt?(this.primaryTouch=e.changedPointers[0].identifier,z.call(this,e)):t&(Ot|Mt)&&z.call(this,e)}function z(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches,o=function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)};setTimeout(o,ie)}}function X(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var o=this.lastTouches[i],r=Math.abs(e-o.x),a=Math.abs(n-o.y);if(r<=oe&&a<=oe)return!0}return!1}function W(t,e){this.manager=t,this.set(e)}function Y(t){if(_(t,ce))return ce;var e=_(t,pe),n=_(t,de);return e&&n?ce:e||n?e?pe:de:_(t,le)?le:ue}function Q(){if(!ae)return!1;var e={},n=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){e[i]=!n||t.CSS.supports("touch-action",i)}),e}function Z(t){this.options=dt({},this.defaults,t||{}),this.id=b(),this.manager=null,this.options.enable=d(this.options.enable,!0),this.state=he,this.simultaneous={},this.requireFail=[]}function J(t){return t&ge?"cancel":t&ve?"end":t&_e?"move":t&ye?"start":""}function K(t){return t==Gt?"down":t==Bt?"up":t==Rt?"left":t==Nt?"right":""}function tt(t,e){var n=e.manager;return n?n.get(t):t}function et(){Z.apply(this,arguments)}function nt(){et.apply(this,arguments),this.pX=null,this.pY=null}function it(){et.apply(this,arguments)}function ot(){Z.apply(this,arguments),this._timer=null,this._input=null}function rt(){et.apply(this,arguments)}function at(){et.apply(this,arguments)}function st(){Z.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ut(t,e){return e=e||{},e.recognizers=d(e.recognizers,ut.defaults.preset),new lt(t,e)}function lt(t,e){this.options=dt({},ut.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=k(this),this.touchAction=new W(this,this.options.touchAction),ct(this,!0),s(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ct(t,e){var n=t.element;if(n.style){var i;s(t.options.cssProps,function(o,r){i=w(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={})}}function pt(t,e){var i=n.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}var dt,ft=["","webkit","Moz","MS","ms","o"],ht=n.createElement("div"),yt="function",_t=Math.round,vt=Math.abs,mt=Date.now;dt="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==o&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var gt=u(function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===o)&&(t[i[r]]=e[i[r]]),r++;return t},"extend","Use `assign`."),xt=u(function(t,e){return gt(t,e,!0)},"merge","Use `assign`."),wt=1,bt=/mobile|tablet|ip(ad|hone|od)|android/i,Ct="ontouchstart"in t,Tt=w(t,"PointerEvent")!==o,kt=Ct&&bt.test(navigator.userAgent),Et="touch",At="pen",Pt="mouse",St="kinect",Ft=25,jt=1,It=2,Ot=4,Mt=8,Dt=1,Rt=2,Nt=4,Bt=8,Gt=16,Ht=Rt|Nt,Lt=Bt|Gt,Vt=Ht|Lt,qt=["x","y"],$t=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(C(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(C(this.element),this.evWin,this.domHandler)}};var Ut={mousedown:jt,mousemove:It,mouseup:Ot},zt="mousedown",Xt="mousemove mouseup";l(B,T,{handler:function(t){var e=Ut[t.type];e&jt&&0===t.button&&(this.pressed=!0),e&It&&1!==t.which&&(e=Ot),this.pressed&&(e&Ot&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Pt,srcEvent:t}))}});var Wt={pointerdown:jt,pointermove:It,pointerup:Ot,pointercancel:Mt,pointerout:Mt},Yt={2:Et,3:At,4:Pt,5:St},Qt="pointerdown",Zt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Qt="MSPointerDown",Zt="MSPointerMove MSPointerUp MSPointerCancel"),l(G,T,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),o=Wt[i],r=Yt[t.pointerType]||t.pointerType,a=r==Et,s=m(e,t.pointerId,"pointerId");o&jt&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):o&(Ot|Mt)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),n&&e.splice(s,1))}});var Jt={touchstart:jt,touchmove:It,touchend:Ot,touchcancel:Mt},Kt="touchstart",te="touchstart touchmove touchend touchcancel";l(H,T,{handler:function(t){var e=Jt[t.type];if(e===jt&&(this.started=!0),this.started){var n=L.call(this,t,e);e&(Ot|Mt)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Et,srcEvent:t})}}});var ee={touchstart:jt,touchmove:It,touchend:Ot,touchcancel:Mt},ne="touchstart touchmove touchend touchcancel";l(V,T,{handler:function(t){var e=ee[t.type],n=q.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Et,srcEvent:t})}});var ie=2500,oe=25;l($,T,{handler:function(t,e,n){var i=n.pointerType==Et,o=n.pointerType==Pt;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)U.call(this,e,n);else if(o&&X.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var re=w(ht.style,"touchAction"),ae=re!==o,se="compute",ue="auto",le="manipulation",ce="none",pe="pan-x",de="pan-y",fe=Q();W.prototype={set:function(t){t==se&&(t=this.compute()),ae&&this.manager.element.style&&fe[t]&&(this.manager.element.style[re]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return s(this.manager.recognizers,function(e){p(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Y(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var i=this.actions,o=_(i,ce)&&!fe[ce],r=_(i,de)&&!fe[de],a=_(i,pe)&&!fe[pe];if(o){var s=1===t.pointers.length,u=t.distance<2,l=t.deltaTime<250;if(s&&u&&l)return}return a&&r?void 0:o||r&&n&Ht||a&&n&Lt?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var he=1,ye=2,_e=4,ve=8,me=ve,ge=16,xe=32;Z.prototype={defaults:{},set:function(t){return dt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(a(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=tt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return a(t,"dropRecognizeWith",this)?this:(t=tt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(a(t,"requireFailure",this))return this;var e=this.requireFail;return t=tt(t,this),m(e,t)===-1&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(a(t,"dropRequireFailure",this))return this;t=tt(t,this);var e=m(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,i=this.state;i<ve&&e(n.options.event+J(i)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),i>=ve&&e(n.options.event+J(i))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=xe)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(xe|he)))return!1;t++}return!0},recognize:function(t){var e=dt({},t);return p(this.options.enable,[this,e])?(this.state&(me|ge|xe)&&(this.state=he),this.state=this.process(e),void(this.state&(ye|_e|ve|ge)&&this.tryEmit(e))):(this.reset(),void(this.state=xe))},process:function(t){},getTouchAction:function(){},reset:function(){}},l(et,Z,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(ye|_e),o=this.attrTest(t);return i&&(n&Mt||!o)?e|ge:i||o?n&Ot?e|ve:e&ye?e|_e:ye:xe}}),l(nt,et,{defaults:{event:"pan",threshold:10,pointers:1,direction:Vt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Ht&&e.push(de),t&Lt&&e.push(pe),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,o=t.direction,r=t.deltaX,a=t.deltaY;return o&e.direction||(e.direction&Ht?(o=0===r?Dt:r<0?Rt:Nt,n=r!=this.pX,i=Math.abs(t.deltaX)):(o=0===a?Dt:a<0?Bt:Gt,n=a!=this.pY,i=Math.abs(t.deltaY))),t.direction=o,n&&i>e.threshold&&o&e.direction},attrTest:function(t){return et.prototype.attrTest.call(this,t)&&(this.state&ye||!(this.state&ye)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=K(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),l(it,et,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ce]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ye)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),l(ot,Z,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ue]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(Ot|Mt)&&!o)this.reset();else if(t.eventType&jt)this.reset(),this._timer=r(function(){this.state=me,this.tryEmit()},e.time,this);else if(t.eventType&Ot)return me;return xe},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===me&&(t&&t.eventType&Ot?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=mt(),this.manager.emit(this.options.event,this._input)))}}),l(rt,et,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ce]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ye);
}}),l(at,et,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ht|Lt,pointers:1},getTouchAction:function(){return nt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Ht|Lt)?e=t.overallVelocity:n&Ht?e=t.overallVelocityX:n&Lt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&vt(e)>this.options.velocity&&t.eventType&Ot},emit:function(t){var e=K(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),l(st,Z,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[le]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&jt&&0===this.count)return this.failTimeout();if(i&&o&&n){if(t.eventType!=Ot)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||M(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&a?this.count+=1:this.count=1,this._input=t;var u=this.count%e.taps;if(0===u)return this.hasRequireFailures()?(this._timer=r(function(){this.state=me,this.tryEmit()},e.interval,this),ye):me}return xe},failTimeout:function(){return this._timer=r(function(){this.state=xe},this.options.interval,this),xe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==me&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ut.VERSION="2.0.7",ut.defaults={domEvents:!1,touchAction:se,enable:!0,inputTarget:null,inputClass:null,preset:[[rt,{enable:!1}],[it,{enable:!1},["rotate"]],[at,{direction:Ht}],[nt,{direction:Ht},["swipe"]],[st],[st,{event:"doubletap",taps:2},["tap"]],[ot]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var we=1,be=2;lt.prototype={set:function(t){return dt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?be:we},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,i=this.recognizers,o=e.curRecognizer;(!o||o&&o.state&me)&&(o=e.curRecognizer=null);for(var r=0;r<i.length;)n=i[r],e.stopped===be||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(t),!o&&n.state&(ye|_e|ve)&&(o=e.curRecognizer=n),r++}},get:function(t){if(t instanceof Z)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(a(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(a(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=m(e,t);n!==-1&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==o&&e!==o){var n=this.handlers;return s(v(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==o){var n=this.handlers;return s(v(t),function(t){e?n[t]&&n[t].splice(m(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&pt(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&ct(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},dt(ut,{INPUT_START:jt,INPUT_MOVE:It,INPUT_END:Ot,INPUT_CANCEL:Mt,STATE_POSSIBLE:he,STATE_BEGAN:ye,STATE_CHANGED:_e,STATE_ENDED:ve,STATE_RECOGNIZED:me,STATE_CANCELLED:ge,STATE_FAILED:xe,DIRECTION_NONE:Dt,DIRECTION_LEFT:Rt,DIRECTION_RIGHT:Nt,DIRECTION_UP:Bt,DIRECTION_DOWN:Gt,DIRECTION_HORIZONTAL:Ht,DIRECTION_VERTICAL:Lt,DIRECTION_ALL:Vt,Manager:lt,Input:T,TouchAction:W,TouchInput:V,MouseInput:B,PointerEventInput:G,TouchMouseInput:$,SingleTouchInput:H,Recognizer:Z,AttrRecognizer:et,Tap:st,Pan:nt,Swipe:at,Pinch:it,Rotate:rt,Press:ot,on:f,off:h,each:s,merge:xt,extend:gt,assign:dt,inherit:l,bindFn:c,prefixed:w});var Ce="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};Ce.Hammer=ut,"function"==typeof define&&define.amd?define(function(){return ut}):"undefined"!=typeof e&&e.exports?e.exports=ut:t[i]=ut}(window,document,"Hammer")},{}],4:[function(t,e,n){(function(t){!function(){var e=function(){this.init()};e.prototype={init:function(){var t=this||i;return t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.mobileAutoEnable=!0,t._setup(),t},volume:function(t){var e=this||i;if(t=parseFloat(t),e.ctx||p(),"undefined"!=typeof t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&(e.masterGain.gain.value=t);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var o=e._howls[n]._getSoundIds(),r=0;r<o.length;r++){var a=e._howls[n]._soundById(o[r]);a&&a._node&&(a._node.volume=a._volume*t)}return e}return e._volume},mute:function(t){var e=this||i;e.ctx||p(),e._muted=t,e.usingWebAudio&&(e.masterGain.gain.value=t?0:e._volume);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var o=e._howls[n]._getSoundIds(),r=0;r<o.length;r++){var a=e._howls[n]._soundById(o[r]);a&&a._node&&(a._node.muted=!!t||a._muted)}return e},unload:function(){for(var t=this||i,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&"undefined"!=typeof t.ctx.close&&(t.ctx.close(),t.ctx=null,p()),t},codecs:function(t){return(this||i)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||i;if(t.state=t.ctx?t.ctx.state||"running":"running",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{var e=new Audio;"undefined"==typeof e.oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{var e=new Audio;e.muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||i,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),o=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33;return t._codecs={mp3:!(r||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_enableMobileAudio:function(){var t=this||i,e=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(t._navigator&&t._navigator.userAgent),n=!!("ontouchend"in window||t._navigator&&t._navigator.maxTouchPoints>0||t._navigator&&t._navigator.msMaxTouchPoints>0);if(!t._mobileEnabled&&t.ctx&&(e||n)){t._mobileEnabled=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var o=function(){var e=t.ctx.createBufferSource();e.buffer=t._scratchBuffer,e.connect(t.ctx.destination),"undefined"==typeof e.start?e.noteOn(0):e.start(0),e.onended=function(){e.disconnect(0),t._mobileEnabled=!0,t.mobileAutoEnable=!1,document.removeEventListener("touchend",o,!0)}};return document.addEventListener("touchend",o,!0),t}},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&"undefined"!=typeof t.ctx.suspend&&i.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then(function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())}))},3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&"undefined"!=typeof t.ctx.resume&&i.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.state="resuming",t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var i=new e,o=function(t){var e=this;return t.src&&0!==t.src.length?void e.init(t):void console.error("An array of source files must be passed with any new Howl.")};o.prototype={init:function(t){var e=this;return i.ctx||p(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onresume=[],e._webAudio=i.usingWebAudio&&!e._html5,"undefined"!=typeof i.ctx&&i.ctx&&i.mobileAutoEnable&&i._enableMobileAudio(),i._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e.load(),e},load:function(){var t=this,e=null;if(i.noAudio)return void t._emit("loaderror",null,"No audio support.");"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var o,a;if(t._format&&t._format[n])o=t._format[n];else{if(a=t._src[n],"string"!=typeof a){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}o=/^data:audio\/([^;,]+);/i.exec(a),o||(o=/\.([^.]+)$/.exec(a.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(i.codecs(o)){e=t._src[n];break}}return e?(t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new r(t),t._webAudio&&s(t),t):void t._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(t,e){var n=this,o=null;if("number"==typeof t)o=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if("undefined"==typeof t){t="__default";for(var r=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(r++,o=n._sounds[a]._id);1===r?t=null:o=null}}var s=o?n._soundById(o):n._inactiveSound();if(!s)return null;if(o&&!t&&(t=s._sprite||"__default"),"loaded"!==n._state&&!n._sprite[t])return n._queue.push({event:"play",action:function(){n.play(n._soundById(s._id)?s._id:void 0)}}),s._id;if(o&&!s._paused)return e||setTimeout(function(){n._emit("play",s._id)},0),s._id;n._webAudio&&i._autoResume();var u=Math.max(0,s._seek>0?s._seek:n._sprite[t][0]/1e3),l=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-u),c=1e3*l/Math.abs(s._rate);s._paused=!1,s._ended=!1,s._sprite=t,s._seek=u,s._start=n._sprite[t][0]/1e3,s._stop=(n._sprite[t][0]+n._sprite[t][1])/1e3,s._loop=!(!s._loop&&!n._sprite[t][2]);var p=s._node;if(n._webAudio){var d=function(){n._refreshBuffer(s);var t=s._muted||n._muted?0:s._volume;p.gain.setValueAtTime(t,i.ctx.currentTime),s._playStart=i.ctx.currentTime,"undefined"==typeof p.bufferSource.start?s._loop?p.bufferSource.noteGrainOn(0,u,86400):p.bufferSource.noteGrainOn(0,u,l):s._loop?p.bufferSource.start(0,u,86400):p.bufferSource.start(0,u,l),c!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),c)),e||setTimeout(function(){n._emit("play",s._id)},0)},f="running"===i.state;"loaded"===n._state&&f?d():(n.once(f?"load":"resume",d,f?s._id:null),n._clearTimer(s._id))}else{var h=function(){p.currentTime=u,p.muted=s._muted||n._muted||i._muted||p.muted,p.volume=s._volume*i.volume(),p.playbackRate=s._rate,setTimeout(function(){p.play(),c!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),c)),e||n._emit("play",s._id)},0)},y="loaded"===n._state&&(window&&window.ejecta||!p.readyState&&i._navigator.isCocoonJS);if(4===p.readyState||y)h();else{var _=function(){h(),p.removeEventListener(i._canPlayEvent,_,!1)};p.addEventListener(i._canPlayEvent,_,!1),n._clearTimer(s._id)}}return s._id},pause:function(t){var e=this;if("loaded"!==e._state)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),i=0;i<n.length;i++){e._clearTimer(n[i]);var o=e._soundById(n[i]);if(o&&!o._paused&&(o._seek=e.seek(n[i]),o._rateSeek=0,o._paused=!0,e._stopFade(n[i]),o._node))if(e._webAudio){if(!o._node.bufferSource)return e;"undefined"==typeof o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),e._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||e._emit("pause",o?o._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var i=n._getSoundIds(t),o=0;o<i.length;o++){n._clearTimer(i[o]);var r=n._soundById(i[o]);if(r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,n._stopFade(i[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)return e||n._emit("stop",r._id),n;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause());r&&!e&&n._emit("stop",r._id)}return n},mute:function(t,e){var n=this;if("loaded"!==n._state)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if("undefined"==typeof e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var o=n._getSoundIds(e),r=0;r<o.length;r++){var a=n._soundById(o[r]);a&&(a._muted=t,n._webAudio&&a._node?a._node.gain.setValueAtTime(t?0:a._volume,i.ctx.currentTime):a._node&&(a._node.muted=!!i._muted||t),n._emit("mute",a._id))}return n},volume:function(){var t,e,n=this,o=arguments;if(0===o.length)return n._volume;if(1===o.length||2===o.length&&"undefined"==typeof o[1]){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?e=parseInt(o[0],10):t=parseFloat(o[0])}else o.length>=2&&(t=parseFloat(o[0]),e=parseInt(o[1],10));var s;if(!("undefined"!=typeof t&&t>=0&&t<=1))return s=e?n._soundById(e):n._sounds[0],s?s._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;"undefined"==typeof e&&(n._volume=t),e=n._getSoundIds(e);for(var u=0;u<e.length;u++)s=n._soundById(e[u]),s&&(s._volume=t,o[2]||n._stopFade(e[u]),n._webAudio&&s._node&&!s._muted?s._node.gain.setValueAtTime(t,i.ctx.currentTime):s._node&&!s._muted&&(s._node.volume=t*i.volume()),n._emit("volume",s._id));return n},fade:function(t,e,n,o){var r=this,a=Math.abs(t-e),s=t>e?"out":"in",u=a/.01,l=u>0?n/u:n;if(l<4&&(u=Math.ceil(u/(4/l)),l=4),"loaded"!==r._state)return r._queue.push({event:"fade",action:function(){r.fade(t,e,n,o)}}),r;r.volume(t,o);for(var c=r._getSoundIds(o),p=0;p<c.length;p++){var d=r._soundById(c[p]);if(d){if(o||r._stopFade(c[p]),r._webAudio&&!d._muted){var f=i.ctx.currentTime,h=f+n/1e3;d._volume=t,d._node.gain.setValueAtTime(t,f),d._node.gain.linearRampToValueAtTime(e,h)}var y=t;d._interval=setInterval(function(t,n){u>0&&(y+="in"===s?.01:-.01),y=Math.max(0,y),y=Math.min(1,y),y=Math.round(100*y)/100,r._webAudio?("undefined"==typeof o&&(r._volume=y),n._volume=y):r.volume(y,t,!0),y===e&&(clearInterval(n._interval),n._interval=null,r.volume(y,t),r._emit("fade",t))}.bind(r,c[p],d),l)}}return r},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,e._emit("fade",t)),e},loop:function(){var t,e,n,i=this,o=arguments;if(0===o.length)return i._loop;if(1===o.length){if("boolean"!=typeof o[0])return n=i._soundById(parseInt(o[0],10)),!!n&&n._loop;t=o[0],i._loop=t}else 2===o.length&&(t=o[0],e=parseInt(o[1],10));for(var r=i._getSoundIds(e),a=0;a<r.length;a++)n=i._soundById(r[a]),n&&(n._loop=t,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return i},rate:function(){var t,e,n=this,o=arguments;if(0===o.length)e=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?e=parseInt(o[0],10):t=parseFloat(o[0])}else 2===o.length&&(t=parseFloat(o[0]),e=parseInt(o[1],10));var s;if("number"!=typeof t)return s=n._soundById(e),s?s._rate:n._rate;if("loaded"!==n._state)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;"undefined"==typeof e&&(n._rate=t),e=n._getSoundIds(e);for(var u=0;u<e.length;u++)if(s=n._soundById(e[u])){s._rateSeek=n.seek(e[u]),s._playStart=n._webAudio?i.ctx.currentTime:s._playStart,s._rate=t,n._webAudio&&s._node&&s._node.bufferSource?s._node.bufferSource.playbackRate.value=t:s._node&&(s._node.playbackRate=t);var l=n.seek(e[u]),c=(n._sprite[s._sprite][0]+n._sprite[s._sprite][1])/1e3-l,p=1e3*c/Math.abs(s._rate);!n._endTimers[e[u]]&&s._paused||(n._clearTimer(e[u]),n._endTimers[e[u]]=setTimeout(n._ended.bind(n,s),p)),n._emit("rate",s._id)}return n},seek:function(){var t,e,n=this,o=arguments;if(0===o.length)e=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?e=parseInt(o[0],10):(e=n._sounds[0]._id,t=parseFloat(o[0]))}else 2===o.length&&(t=parseFloat(o[0]),e=parseInt(o[1],10));if("undefined"==typeof e)return n;if("loaded"!==n._state)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var s=n._soundById(e);if(s){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var u=n.playing(e)?i.ctx.currentTime-s._playStart:0,l=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(l+u*Math.abs(s._rate))}return s._node.currentTime}var c=n.playing(e);c&&n.pause(e,!0),s._seek=t,s._ended=!1,n._clearTimer(e),c&&n.play(e,!0),!n._webAudio&&s._node&&(s._node.currentTime=t),n._emit("seek",e)}return n},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var i=0;i<e._sounds.length;i++)if(!e._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,i=e._soundById(t);return i&&(n=e._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++){e[n]._paused||(t.stop(e[n]._id),t._emit("end",e[n]._id)),t._webAudio||(e[n]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(i._canPlayEvent,e[n]._loadFn,!1)),delete e[n]._node,t._clearTimer(e[n]._id);var o=i._howls.indexOf(t);o>=0&&i._howls.splice(o,1)}var r=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===t._src){r=!1;break}return a&&r&&delete a[t._src],i.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,i){var o=this,r=o["_on"+t];return"function"==typeof e&&r.push(i?{id:n,fn:e,once:i}:{id:n,fn:e}),o},off:function(t,e,n){var i=this,o=i["_on"+t],r=0;if(e){for(r=0;r<o.length;r++)if(e===o[r].fn&&n===o[r].id){o.splice(r,1);break}}else if(t)i["_on"+t]=[];else{var a=Object.keys(i);for(r=0;r<a.length;r++)0===a[r].indexOf("_on")&&Array.isArray(i[a[r]])&&(i[a[r]]=[])}return i},once:function(t,e,n){var i=this;return i.on(t,e,n,1),i},_emit:function(t,e,n){for(var i=this,o=i["_on"+t],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(i,o[r].fn),0),o[r].once&&i.off(t,o[r].fn,o[r].id));return i},_loadQueue:function(){var t=this;if(t._queue.length>0){var e=t._queue[0];t.once(e.event,function(){t._queue.shift(),t._loadQueue()}),e.action()}return t},_ended:function(t){var e=this,n=t._sprite,o=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&o&&e.stop(t._id,!0).play(t._id),e._webAudio&&o){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=i.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),r)}return e._webAudio&&!o&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),i._autoSuspend()),e._webAudio||o||e.stop(t._id),e},_clearTimer:function(t){var e=this;return e._endTimers[t]&&(clearTimeout(e._endTimers[t]),delete e._endTimers[t]),e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new r(t)},_drain:function(){var t=this,e=t._pool,n=0,i=0;if(!(t._sounds.length<e)){for(i=0;i<t._sounds.length;i++)t._sounds[i]._ended&&n++;for(i=t._sounds.length-1;i>=0;i--){if(n<=e)return;t._sounds[i]._ended&&(t._webAudio&&t._sounds[i]._node&&t._sounds[i]._node.disconnect(0),t._sounds.splice(i,1),n--)}}},_getSoundIds:function(t){var e=this;if("undefined"==typeof t){for(var n=[],i=0;i<e._sounds.length;i++)n.push(e._sounds[i]._id);return n}return[t]},_refreshBuffer:function(t){var e=this;return t._node.bufferSource=i.ctx.createBufferSource(),t._node.bufferSource.buffer=a[e._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop),t._node.bufferSource.playbackRate.value=t._rate,e},_cleanBuffer:function(t){var e=this;if(e._scratchBuffer){t.bufferSource.onended=null,t.bufferSource.disconnect(0);try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}}return t.bufferSource=null,e}};var r=function(t){this._parent=t,this.init()};r.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._muted=e._muted,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=Math.round(Date.now()*Math.random()),e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=i._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node="undefined"==typeof i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),t._node.gain.setValueAtTime(n,i.ctx.currentTime),t._node.paused=!0,t._node.connect(i.masterGain)):(t._node=new Audio,t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(i._canPlayEvent,t._loadFn,!1),t._node.src=e._src,t._node.preload="auto",t._node.volume=n*i.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._muted=e._muted,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=Math.round(Date.now()*Math.random()),t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorListener,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(i._canPlayEvent,t._loadFn,!1)}};var a={},s=function(t){var e=t._src;if(a[e])return t._duration=a[e].duration,void c(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);l(i.buffer,t)}else{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){var e=(r.status+"")[0];return"0"!==e&&"2"!==e&&"3"!==e?void t._emit("loaderror",null,"Failed loading audio file with status: "+r.status+"."):void l(r.response,t)},r.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete a[e],t.load())},u(r)}},u=function(t){try{t.send()}catch(e){t.onerror()}},l=function(t,e){i.ctx.decodeAudioData(t,function(t){t&&e._sounds.length>0&&(a[e._src]=t,c(e,t))},function(){e._emit("loaderror",null,"Decoding audio data failed.")})},c=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},p=function(){try{"undefined"!=typeof AudioContext?i.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch(t){i.usingWebAudio=!1}var t=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),e=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var o=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());(i._navigator&&i._navigator.standalone&&!o||i._navigator&&!i._navigator.standalone&&!o)&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain="undefined"==typeof i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.value=1,i.masterGain.connect(i.ctx.destination)),i._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:i,Howl:o}}),"undefined"!=typeof n&&(n.Howler=i,n.Howl=o),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=i,window.Howl=o,window.Sound=r):"undefined"!=typeof t&&(t.HowlerGlobal=e,t.Howler=i,t.Howl=o,t.Sound=r)}(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var i=this;return i.ctx&&i.ctx.listener?(e="number"!=typeof e?i._pos[1]:e,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof t?i._pos:(i._pos=[t,e,n],i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(t,e,n,i,o,r){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return e="number"!=typeof e?s[1]:e,n="number"!=typeof n?s[2]:n,i="number"!=typeof i?s[3]:i,o="number"!=typeof o?s[4]:o,r="number"!=typeof r?s[5]:r,"number"!=typeof t?s:(a._orientation=[t,e,n,i,o,r],a.ctx.listener.setOrientation(t,e,n,i,o,r),a)},Howl.prototype.init=function(t){return function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:"undefined"!=typeof e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:"undefined"!=typeof e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:"undefined"!=typeof e.coneOuterGain?e.coneOuterGain:0,distanceModel:"undefined"!=typeof e.distanceModel?e.distanceModel:"inverse",maxDistance:"undefined"!=typeof e.maxDistance?e.maxDistance:1e4,panningModel:"undefined"!=typeof e.panningModel?e.panningModel:"HRTF",refDistance:"undefined"!=typeof e.refDistance?e.refDistance:1,rolloffFactor:"undefined"!=typeof e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var o="undefined"==typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"==typeof n){if("number"!=typeof e)return i._stereo;i._stereo=e,i._pos=[e,0,0]}for(var r=i._getSoundIds(n),a=0;a<r.length;a++){var s=i._soundById(r[a]);if(s){if("number"!=typeof e)return s._stereo;s._stereo=e,s._pos=[e,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||t(s,o),"spatial"===o?s._panner.setPosition(e,0,0):s._panner.pan.value=e),i._emit("stereo",s._id)}}return i},Howl.prototype.pos=function(e,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(e,n,i,o)}}),r;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,"undefined"==typeof o){if("number"!=typeof e)return r._pos;r._pos=[e,n,i]}for(var a=r._getSoundIds(o),s=0;s<a.length;s++){var u=r._soundById(a[s]);if(u){if("number"!=typeof e)return u._pos;u._pos=[e,n,i],u._node&&(u._panner&&!u._panner.pan||t(u,"spatial"),u._panner.setPosition(e,n,i)),r._emit("pos",u._id)}}return r},Howl.prototype.orientation=function(e,n,i,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(e,n,i,o)}}),r;if(n="number"!=typeof n?r._orientation[1]:n,i="number"!=typeof i?r._orientation[2]:i,"undefined"==typeof o){if("number"!=typeof e)return r._orientation;r._orientation=[e,n,i]}for(var a=r._getSoundIds(o),s=0;s<a.length;s++){var u=r._soundById(a[s]);if(u){if("number"!=typeof e)return u._orientation;u._orientation=[e,n,i],u._node&&(u._panner||(u._pos||(u._pos=r._pos||[0,0,-.5]),t(u,"spatial")),u._panner.setOrientation(e,n,i)),r._emit("orientation",u._id)}}return r},Howl.prototype.pannerAttr=function(){var e,n,i,o=this,r=arguments;if(!o._webAudio)return o;if(0===r.length)return o._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return i=o._soundById(parseInt(r[0],10)),i?i._pannerAttr:o._pannerAttr;e=r[0],"undefined"==typeof n&&(o._pannerAttr={coneInnerAngle:"undefined"!=typeof e.coneInnerAngle?e.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:"undefined"!=typeof e.coneOuterAngle?e.coneOuterAngle:o._coneOuterAngle,coneOuterGain:"undefined"!=typeof e.coneOuterGain?e.coneOuterGain:o._coneOuterGain,distanceModel:"undefined"!=typeof e.distanceModel?e.distanceModel:o._distanceModel,maxDistance:"undefined"!=typeof e.maxDistance?e.maxDistance:o._maxDistance,panningModel:"undefined"!=typeof e.panningModel?e.panningModel:o._panningModel,refDistance:"undefined"!=typeof e.refDistance?e.refDistance:o._refDistance,rolloffFactor:"undefined"!=typeof e.rolloffFactor?e.rolloffFactor:o._rolloffFactor})}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=o._getSoundIds(n),s=0;s<a.length;s++)if(i=o._soundById(a[s])){var u=i._pannerAttr;u={coneInnerAngle:"undefined"!=typeof e.coneInnerAngle?e.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:"undefined"!=typeof e.coneOuterAngle?e.coneOuterAngle:u.coneOuterAngle,coneOuterGain:"undefined"!=typeof e.coneOuterGain?e.coneOuterGain:u.coneOuterGain,distanceModel:"undefined"!=typeof e.distanceModel?e.distanceModel:u.distanceModel,maxDistance:"undefined"!=typeof e.maxDistance?e.maxDistance:u.maxDistance,panningModel:"undefined"!=typeof e.panningModel?e.panningModel:u.panningModel,refDistance:"undefined"!=typeof e.refDistance?e.refDistance:u.refDistance,rolloffFactor:"undefined"!=typeof e.rolloffFactor?e.rolloffFactor:u.rolloffFactor
};var l=i._panner;l?(l.coneInnerAngle=u.coneInnerAngle,l.coneOuterAngle=u.coneOuterAngle,l.coneOuterGain=u.coneOuterGain,l.distanceModel=u.distanceModel,l.maxDistance=u.maxDistance,l.panningModel=u.panningModel,l.refDistance=u.refDistance,l.rolloffFactor=u.rolloffFactor):(i._pos||(i._pos=o._pos||[0,0,-.5]),t(i,"spatial"))}return o},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this)}}(Sound.prototype.reset);var t=function(t,e){e=e||"spatial","spatial"===e?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.panningModel=t._pannerAttr.panningModel,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.value=t._stereo),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id)}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,n){function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(p===setTimeout)return setTimeout(t,0);if((p===i||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function a(t){if(d===clearTimeout)return clearTimeout(t);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function s(){_&&h&&(_=!1,h.length?y=h.concat(y):v=-1,y.length&&u())}function u(){if(!_){var t=r(s);_=!0;for(var e=y.length;e;){for(h=y,y=[];++v<e;)h&&h[v].run();v=-1,e=y.length}h=null,_=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var p,d,f=e.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:i}catch(t){p=i}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(t){d=o}}();var h,y=[],_=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];y.push(new l(t,e)),1!==y.length||_||r(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],6:[function(t,e,n){"use strict";function i(t){var e=t.parent.data.originalColor;return o(e)}function o(t){return t?(t=t.toUpperCase(),t in s.palette.colorNames?s.palette.colorNames[t]:null):null}function r(){var t=s.palette.pops;return t[Math.floor(Math.random()*t.length)]}function a(t){var e=s.palette.pops;return e[t%e.length]}Object.defineProperty(n,"__esModule",{value:!0}),n.getPathColorName=i,n.getColorName=o,n.getRandomPop=r,n.getIndexedPopColor=a;var s=t("./../../config");n.transparent=new Color(0,0)},{"./../../config":1}],7:[function(t,e,n){"use strict";!function(t,n){"function"==typeof define&&define.amd?define([],n):"undefined"!=typeof e&&e.exports?e.exports=n():t.ShapeDetector=n()}(void 0,function(){function t(t){return t*Math.PI/180}function e(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)}function n(t,e){this.points=t,this.name=e,this.processStroke()}function i(t,e){e=e||{},this.threshold=e.threshold||0,o=e.nbSamplePoints||64,this.patterns=[];for(var n=0;n<t.length;n++)this.learn(t[n].name,t[n].points)}var o,r=250,a=.5*(-1+Math.sqrt(5)),s=t(45),u=t(2),l=.5*Math.sqrt(r*r+r*r),c={x:0,y:0};return n.prototype.processStroke=function(){return this.points=this.resample(),this.setCentroid(),this.points=this.rotateBy(-this.indicativeAngle()),this.points=this.scaleToSquare(),this.setCentroid(),this.points=this.translateToOrigin(),this},n.prototype.resample=function(){for(var t,n,i=this.strokeLength()/(o-1),r=0,a=[this.points[0]],s=1;s<this.points.length;s++)t=e(this.points[s-1],this.points[s]),r+t>=i?(n={x:this.points[s-1].x+(i-r)/t*(this.points[s].x-this.points[s-1].x),y:this.points[s-1].y+(i-r)/t*(this.points[s].y-this.points[s-1].y)},a.push(n),this.points.splice(s,0,n),r=0):r+=t;return a.length===o-1&&a.push(this.points[this.points.length-1]),a},n.prototype.rotateBy=function(t){for(var e,n=Math.cos(t),i=Math.sin(t),o=[],r=0;r<this.points.length;r++)e=this.points[r],o.push({x:(e.x-this.c.x)*n-(e.y-this.c.y)*i+this.c.x,y:(e.x-this.c.x)*i+(e.y-this.c.y)*n+this.c.y});return o},n.prototype.scaleToSquare=function(){for(var t,e=[],n={minX:+(1/0),maxX:-(1/0),minY:+(1/0),maxY:-(1/0)},i=0;i<this.points.length;i++)t=this.points[i],n.minX=Math.min(n.minX,t.x),n.minY=Math.min(n.minY,t.y),n.maxX=Math.max(n.maxX,t.x),n.maxY=Math.max(n.maxY,t.y);for(n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,i=0;i<this.points.length;i++)t=this.points[i],e.push({x:t.x*(r/n.width),y:t.y*(r/n.height)});return e},n.prototype.translateToOrigin=function(t){for(var e,n=[],i=0;i<this.points.length;i++)e=this.points[i],n.push({x:e.x+c.x-this.c.x,y:e.y+c.y-this.c.y});return n},n.prototype.setCentroid=function(){var t;this.c={x:0,y:0};for(var e=0;e<this.points.length;e++)t=this.points[e],this.c.x+=t.x,this.c.y+=t.y;return this.c.x/=this.points.length,this.c.y/=this.points.length,this},n.prototype.indicativeAngle=function(){return Math.atan2(this.c.y-this.points[0].y,this.c.x-this.points[0].x)},n.prototype.strokeLength=function(){for(var t=0,n=1;n<this.points.length;n++)t+=e(this.points[n-1],this.points[n]);return t},n.prototype.distanceAtBestAngle=function(t){for(var e=-s,n=s,i=a*e+(1-a)*n,o=this.distanceAtAngle(t,i),r=(1-a)*e+a*n,l=this.distanceAtAngle(t,r);Math.abs(n-e)>u;)o<l?(n=r,r=i,l=o,i=a*e+(1-a)*n,o=this.distanceAtAngle(t,i)):(e=i,i=r,o=l,r=(1-a)*e+a*n,l=this.distanceAtAngle(t,r));return Math.min(o,l)},n.prototype.distanceAtAngle=function(t,n){for(var i=this.rotateBy(n),o=t.points,r=0,a=0;a<i.length;a++)r+=e(i[a],o[a]);return r/i.length},i.defaultShapes=[{points:[{x:0,y:50},{x:100,y:50}],name:"line"},{points:[{x:50,y:0},{x:50,y:100}],name:"line"},{points:[{x:0,y:0},{x:100,y:100}],name:"line"},{points:[{x:89,y:164},{x:90,y:162},{x:92,y:162},{x:94,y:164},{x:95,y:166},{x:96,y:169},{x:97,y:171},{x:99,y:175},{x:101,y:178},{x:103,y:182},{x:106,y:189},{x:108,y:194},{x:111,y:199},{x:114,y:204},{x:117,y:209},{x:119,y:214},{x:122,y:218},{x:124,y:222},{x:126,y:225},{x:128,y:228},{x:130,y:229},{x:133,y:233},{x:134,y:236},{x:136,y:239},{x:138,y:240},{x:139,y:242},{x:140,y:244},{x:142,y:242},{x:142,y:240},{x:142,y:237},{x:143,y:235},{x:143,y:233},{x:145,y:229},{x:146,y:226},{x:148,y:217},{x:149,y:208},{x:149,y:205},{x:151,y:196},{x:151,y:193},{x:153,y:182},{x:155,y:172},{x:157,y:165},{x:159,y:160},{x:162,y:155},{x:164,y:150},{x:165,y:148},{x:166,y:146}],name:"line"},{points:[{x:91,y:185},{x:93,y:185},{x:95,y:185},{x:97,y:185},{x:100,y:188},{x:102,y:189},{x:104,y:190},{x:106,y:193},{x:108,y:195},{x:110,y:198},{x:112,y:201},{x:114,y:204},{x:115,y:207},{x:117,y:210},{x:118,y:212},{x:120,y:214},{x:121,y:217},{x:122,y:219},{x:123,y:222},{x:124,y:224},{x:126,y:226},{x:127,y:229},{x:129,y:231},{x:130,y:233},{x:129,y:231},{x:129,y:228},{x:129,y:226},{x:129,y:224},{x:129,y:221},{x:129,y:218},{x:129,y:212},{x:129,y:208},{x:130,y:198},{x:132,y:189},{x:134,y:182},{x:137,y:173},{x:143,y:164},{x:147,y:157},{x:151,y:151},{x:155,y:144},{x:161,y:137},{x:165,y:131},{x:171,y:122},{x:174,y:118},{x:176,y:114},{x:177,y:112},{x:177,y:114},{x:175,y:116},{x:173,y:118}],name:"line"},{points:[{x:113,y:68},{x:86,y:79},{x:63,y:131},{x:78,y:147},{x:156,y:149},{x:195,y:100},{x:189,y:79},{x:125.73497,y:62.81168}],name:"circle"},{points:[{x:98,y:67},{x:77,y:85},{x:77,y:162},{x:179,y:156},{x:197,y:123},{x:167,y:63},{x:141,y:61},{x:110,y:59},{x:106.51192,y:59.70407}],name:"circle"},{points:[{x:60,y:47},{x:43,y:96},{x:52,y:206},{x:63,y:246},{x:118,y:296},{x:144,y:246},{x:141,y:147},{x:133,y:129},{x:113,y:80},{x:60.42738,y:45.76813}],name:"circle"},{points:[{x:127,y:141},{x:124,y:140},{x:120,y:139},{x:118,y:139},{x:116,y:139},{x:111,y:140},{x:109,y:141},{x:104,y:144},{x:100,y:147},{x:96,y:152},{x:93,y:157},{x:90,y:163},{x:87,y:169},{x:85,y:175},{x:83,y:181},{x:82,y:190},{x:82,y:195},{x:83,y:200},{x:84,y:205},{x:88,y:213},{x:91,y:216},{x:96,y:219},{x:103,y:222},{x:108,y:224},{x:111,y:224},{x:120,y:224},{x:133,y:223},{x:142,y:222},{x:152,y:218},{x:160,y:214},{x:167,y:210},{x:173,y:204},{x:178,y:198},{x:179,y:196},{x:182,y:188},{x:182,y:177},{x:178,y:167},{x:170,y:150},{x:163,y:138},{x:152,y:130},{x:143,y:129},{x:140,y:131},{x:129,y:136},{x:126,y:139}],name:"circle"},{points:[{x:516,y:284},{x:496,y:319},{x:496,y:329},{x:513,y:329},{x:550,y:324},{x:696,y:305},{x:737,y:298},{x:746,y:292},{x:734,y:278},{x:709,y:252},{x:664,y:193}],name:"triangle"},{points:[{x:179,y:159},{x:152,y:290},{x:143,y:336},{x:142,y:355},{x:160,y:348},{x:208,y:337},{x:241,y:330},{x:256,y:328},{x:254,y:315},{x:238,y:277},{x:210,y:200},{x:182.94356,y:110.45656}],name:"triangle"},{points:[{x:105,y:335},{x:115,y:362},{x:128,y:338},{x:163,y:271},{x:241,y:135},{x:261,y:104},{x:267,y:98},{x:261,y:102},{x:236,y:119},{x:151,y:195},{x:108,y:235},{x:83,y:267},{x:79.92616,y:270.93451}],name:"triangle"},{points:[{x:137,y:139},{x:135,y:141},{x:133,y:144},{x:132,y:146},{x:130,y:149},{x:128,y:151},{x:126,y:155},{x:123,y:160},{x:120,y:166},{x:116,y:171},{x:112,y:177},{x:107,y:183},{x:102,y:188},{x:100,y:191},{x:95,y:195},{x:90,y:199},{x:86,y:203},{x:82,y:206},{x:80,y:209},{x:75,y:213},{x:73,y:213},{x:70,y:216},{x:67,y:219},{x:64,y:221},{x:61,y:223},{x:60,y:225},{x:62,y:226},{x:65,y:225},{x:67,y:226},{x:74,y:226},{x:77,y:227},{x:85,y:229},{x:91,y:230},{x:99,y:231},{x:108,y:232},{x:116,y:233},{x:125,y:233},{x:134,y:234},{x:145,y:233},{x:153,y:232},{x:160,y:233},{x:170,y:234},{x:177,y:235},{x:179,y:236},{x:186,y:237},{x:193,y:238},{x:198,y:239},{x:200,y:237},{x:202,y:239},{x:204,y:238},{x:206,y:234},{x:205,y:230},{x:202,y:222},{x:197,y:216},{x:192,y:207},{x:186,y:198},{x:179,y:189},{x:174,y:183},{x:170,y:178},{x:164,y:171},{x:161,y:168},{x:154,y:160},{x:148,y:155},{x:143,y:150},{x:138,y:148},{x:136,y:148}],name:"triangle"},{points:[{x:0,y:0},{x:0,y:50},{x:50,y:50},{x:50,y:0}],name:"square"},{points:[{x:0,y:0},{x:0,y:100},{x:50,y:100},{x:50,y:0}],name:"square"},{points:[{x:78,y:149},{x:78,y:153},{x:78,y:157},{x:78,y:160},{x:79,y:162},{x:79,y:164},{x:79,y:167},{x:79,y:169},{x:79,y:173},{x:79,y:178},{x:79,y:183},{x:80,y:189},{x:80,y:193},{x:80,y:198},{x:80,y:202},{x:81,y:208},{x:81,y:210},{x:81,y:216},{x:82,y:222},{x:82,y:224},{x:82,y:227},{x:83,y:229},{x:83,y:231},{x:85,y:230},{x:88,y:232},{x:90,y:233},{x:92,y:232},{x:94,y:233},{x:99,y:232},{x:102,y:233},{x:106,y:233},{x:109,y:234},{x:117,y:235},{x:123,y:236},{x:126,y:236},{x:135,y:237},{x:142,y:238},{x:145,y:238},{x:152,y:238},{x:154,y:239},{x:165,y:238},{x:174,y:237},{x:179,y:236},{x:186,y:235},{x:191,y:235},{x:195,y:233},{x:197,y:233},{x:200,y:233},{x:201,y:235},{x:201,y:233},{x:199,y:231},{x:198,y:226},{x:198,y:220},{x:196,y:207},{x:195,y:195},{x:195,y:181},{x:195,y:173},{x:195,y:163},{x:194,y:155},{x:192,y:145},{x:192,y:143},{x:192,y:138},{x:191,y:135},{x:191,y:133},{x:191,y:130},{x:190,y:128},{x:188,y:129},{x:186,y:129},{x:181,y:132},{x:173,y:131},{x:162,y:131},{x:151,y:132},{x:149,y:132},{x:138,y:132},{x:136,y:132},{x:122,y:131},{x:120,y:131},{x:109,y:130},{x:107,y:130},{x:90,y:132},{x:81,y:133},{x:76,y:133}],name:"square"},{points:[{x:67,y:172},{x:80,y:85},{x:83,y:58},{x:83,y:54},{x:136,y:110},{x:157,y:136},{x:162,y:140},{x:166,y:143},{x:80,y:124},{x:45,y:116},{x:37,y:114},{x:31,y:113},{x:52,y:106},{x:101,y:86},{x:131,y:75},{x:157,y:63},{x:163,y:62},{x:158,y:64},{x:153,y:73},{x:128,y:103},{x:71,y:170}],name:"other"},{points:[{x:30,y:69},{x:116,y:118},{x:90,y:164},{x:75,y:117},{x:157,y:83},{x:182,y:140},{x:155,y:163},{x:144,y:119},{x:221,y:54}],name:"other"},{points:[{x:87,y:76},{x:62,y:73},{x:100,y:98},{x:107,y:57},{x:61,y:38},{x:73,y:137}],name:"other"},{points:[{x:123,y:129},{x:123,y:131},{x:124,y:133},{x:125,y:136},{x:127,y:140},{x:129,y:142},{x:133,y:148},{x:137,y:154},{x:143,y:158},{x:145,y:161},{x:148,y:164},{x:153,y:170},{x:158,y:176},{x:160,y:178},{x:164,y:183},{x:168,y:188},{x:171,y:191},{x:175,y:196},{x:178,y:200},{x:180,y:202},{x:181,y:205},{x:184,y:208},{x:186,y:210},{x:187,y:213},{x:188,y:215},{x:186,y:212},{x:183,y:211},{x:177,y:208},{x:169,y:206},{x:162,y:205},{x:154,y:207},{x:145,y:209},{x:137,y:210},{x:129,y:214},{x:122,y:217},{x:118,y:218},{x:111,y:221},{x:109,y:222},{x:110,y:219},{x:112,y:217},{x:118,y:209},{x:120,y:207},{x:128,y:196},{x:135,y:187},{x:138,y:183},{x:148,y:167},{x:157,y:153},{x:163,y:145},{x:165,y:142},{x:172,y:133},{x:177,y:127},{x:179,y:127},{x:180,y:125}],name:"other"},{points:[{x:81,y:219},{x:84,y:218},{x:86,y:220},{x:88,y:220},{x:90,y:220},{x:92,y:219},{x:95,y:220},{x:97,y:219},{x:99,y:220},{x:102,y:218},{x:105,y:217},{x:107,y:216},{x:110,y:216},{x:113,y:214},{x:116,y:212},{x:118,y:210},{x:121,y:208},{x:124,y:205},{x:126,y:202},{x:129,y:199},{x:132,y:196},{x:136,y:191},{x:139,y:187},{x:142,y:182},{x:144,y:179},{x:146,y:174},{x:148,y:170},{x:149,y:168},{x:151,y:162},{x:152,y:160},{x:152,y:157},{x:152,y:155},{x:152,y:151},{x:152,y:149},{x:152,y:146},{x:149,y:142},{x:148,y:139},{x:145,y:137},{x:141,y:135},{x:139,y:135},{x:134,y:136},{x:130,y:140},{x:128,y:142},{x:126,y:145},{x:122,y:150},{x:119,y:158},{x:117,y:163},{x:115,y:170},{x:114,y:175},{x:117,y:184},{x:120,y:190},{x:125,y:199},{x:129,y:203},{x:133,y:208},{x:138,y:213},{x:145,y:215},{x:155,y:218},{x:164,y:219},{x:166,y:219},{x:177,y:219},{x:182,y:218},{x:192,y:216},{x:196,y:213},{x:199,y:212},{x:201,y:211}],name:"other"},{points:[{x:75,y:250},{x:75,y:247},{x:77,y:244},{x:78,y:242},{x:79,y:239},{x:80,y:237},{x:82,y:234},{x:82,y:232},{x:84,y:229},{x:85,y:225},{x:87,y:222},{x:88,y:219},{x:89,y:216},{x:91,y:212},{x:92,y:208},{x:94,y:204},{x:95,y:201},{x:96,y:196},{x:97,y:194},{x:98,y:191},{x:100,y:185},{x:102,y:178},{x:104,y:173},{x:104,y:171},{x:105,y:164},{x:106,y:158},{x:107,y:156},{x:107,y:152},{x:108,y:145},{x:109,y:141},{x:110,y:139},{x:112,y:133},{x:113,y:131},{x:116,y:127},{x:117,y:125},{x:119,y:122},{x:121,y:121},{x:123,y:120},{x:125,y:122},{x:125,y:125},{x:127,y:130},{x:128,y:133},{x:131,y:143},{x:136,y:153},{x:140,y:163},{x:144,y:172},{x:145,y:175},{x:151,y:189},{x:156,y:201},{x:161,y:213},{x:166,y:225},{x:169,y:233},{x:171,y:236},{x:174,y:243},{x:177,y:247},{x:178,y:249},{x:179,y:251},{x:180,y:253},{x:180,y:255},{x:179,y:257},{x:177,y:257},{x:174,y:255},{x:169,y:250},{x:164,y:247},{x:160,y:245},{x:149,y:238},{x:138,y:230},{x:127,y:221},{x:124,y:220},{x:112,y:212},{x:110,y:210},{x:96,y:201},{x:84,y:195},{x:74,y:190},{x:64,y:182},{x:55,y:175},{x:51,y:172},{x:49,y:170},{x:51,y:169},{x:56,y:169},{x:66,y:169},{x:78,y:168},{x:92,y:166},{x:107,y:164},{x:123,y:161},{x:140,y:162},{x:156,y:162},{x:171,y:160},{x:173,y:160},{x:186,y:160},{x:195,y:160},{x:198,y:161},{x:203,y:163},{x:208,y:163},{x:206,y:164},{x:200,y:167},{x:187,y:172},{x:174,y:179},{x:172,y:181},{x:153,y:192},{x:137,y:201},{x:123,y:211},{x:112,y:220},{x:99,y:229},{x:90,y:237},{x:80,y:244},{x:73,y:250},{x:69,y:254},{x:69,y:252}],name:"other"}],i.prototype.spot=function(t,e){null==e&&(e="");for(var i,o,r,a=new n(t),s=+(1/0),u=null,c=0,p=0;p<this.patterns.length;p++)o=this.patterns[p],o.name.indexOf(e)>-1&&(i=a.distanceAtBestAngle(o),r=1-i/l,i<s&&r>this.threshold&&(s=i,u=o.name,c=r));return{pattern:u,score:c}},i.prototype.learn=function(t,e){return this.patterns.push(new n(e,t))},i})},{}],8:[function(t,e,n){"use strict";function i(){window.kan={currentColor:"#2B5E2E",composition:[],compositionInterval:null,compositionTimeout:null,soundTimeouts:[],lastEvent:null,interaction:!1,moves:[],playing:!1,pinching:!1,pinchedGroup:null,pinchedTut:null,pathData:{},shapePath:null,prevAngle:null,sides:[],side:[],corners:[],lastScale:1,lastRotation:0,originalPosition:null,tutorialCompletion:{fill:!1,pinch:!1,swipe:!1},inactivityTimeout:null,playPromptTimeout:null,userHasDrawnFirstShape:!1,firstTimePlaying:!0,shapesSinceTut:0,refreshCheckInterval:null,sha:null,scheduledOverlay:null,continueCountdownInterval:null,shapeSounds:null}}Object.defineProperty(n,"__esModule",{value:!0}),n.resetWindow=i;var o=t("./touch"),r=t("./ui"),a=t("./overlays"),s=(t("./video"),t("./timing")),u=t("./util"),l=t("./sound");$(window).on("load",function(){function t(){i(),u.setSha(),r.init(),a.init(),s.init(),l.init().then(function(){o.init()}).fail(function(t){console.error("error initting shape sounds:",t),location.reload()})}try{t()}catch(t){console.error(t),setTimeout(function(){location.reload()},5e3)}})},{"./overlays":9,"./sound":11,"./timing":12,"./touch":13,"./ui":15,"./util":16,"./video":17}],9:[function(t,e,n){"use strict";function i(t){if(window.kan.overlays!==!1&&D.includes(t)){if(window.kan.pinching===!0||window.kan.panning===!0)return void("continue"===t?T.preventInactivityTimeout():window.kan.scheduledOverlay=t);switch(h(),k.hideContextualTuts(),A.addClass(N),A.find(".overlay:not(.tips)").on(P,function(){h()}),t){case"intro":o();break;case"play-prompt":E.anyShapesOnCanvas()?r():window.kan.playPromptTimeout=setTimeout(function(){i("play-prompt")},T.playPromptDelay/2);break;case"share-prompt":a();break;case"continue":u();break;case"tips":l();break;case"share":c()}}}function o(){A.addClass("intro-active")}function r(){A.addClass("play-prompt-active")}function a(){A.addClass("share-prompt-active")}function s(){$(".overlay.continue .countdown-num").html(parseInt(T.continueInactivityDelay/1e3)),clearInterval(window.kan.continueCountdownInterval)}function u(){A.addClass("continue-active"),s(),clearTimeout(window.kan.inactivityTimeout),clearTimeout(window.kan.playPromptTimeout),window.kan.continueCountdownInterval=setInterval(function(){var t=$(".overlay.continue .countdown-num"),e=parseInt(t.html());e>1&&t.html(e-1)},1e3),window.kan.inactivityTimeout=setTimeout(function(){C.enterTutorialMode()},T.continueInactivityDelay)}function l(){A.addClass("tips-active"),y()}function c(){A.addClass("share-active")}function p(){var t=A.find(".card-wrap .current"),e=t.next().length?t.next():F.first(),n=e.next().length?e.next():F.first(),i=n.next().length?n.next():F.first().next(),o=e.index();t.removeClass().addClass("remove"),e.removeClass().addClass("current"),n.removeClass().addClass("next"),i.removeClass().addClass("third"),_(o+1,j),setTimeout(function(){t.removeClass()},600)}function d(){var t=0;A.find(".overlay").on(P,function(e){var n=Date.now();t>n-250||(t=n,1==$(e.target).closest(".card-wrap").length?p():h())})}function f(){F.removeClass(),O.html("")}function h(){A.removeClass("overlay-active"),A.removeClass(R),f()}function y(){var t=F.first(),e=t.next().length?t.next():F.first(),n=e.next().length?e.next():F.first().next();F.removeClass(),t.removeClass().addClass("current"),e.removeClass().addClass("next"),n.removeClass().addClass("third"),_(1,j)}function _(t,e){I.find(".current").html(t),I.find(".next").html(e)}function v(){O.mask("000-000-0000"),M.find(".num").on(P,function(t){var e=O.html().toString()+$(t.target).html().toString();e=O.masked(e),O.html(e)}),M.find(".clear").on(P,function(t){O.html("")})}function m(){A.find(".card-wrap article").each(function(t,e){$(e).attr("data-bg",t)})}function g(){d()}function x(){v(),m()}function w(){g(),x()}Object.defineProperty(n,"__esModule",{value:!0}),n.openOverlay=i,n.resetContinueCountdown=s,n.cardNavNext=p,n.closeAndResetOverlays=h,n.init=w;var b=(t("./../../config"),t("./touch")),C=t("./video"),T=t("./timing"),k=t("./tutorial"),E=t("./util"),A=(b.hammerCanvas,$("body")),P="click tap touch",S=A.find(".overlay.tips .card-wrap"),F=S.find("article"),j=F.length,I=A.find(".overlay.tips .footer"),O=A.find("#phone"),M=A.find(".keypad"),D=["intro","play-prompt","share-prompt","continue","tips","share"],R=D.map(function(t){return t+"-active"}).join(" "),N="overlay-active"},{"./../../config":1,"./timing":12,"./touch":13,"./tutorial":14,"./util":16,"./video":17}],10:[function(t,e,n){"use strict";function i(t){var e=E.getGroupPops(t);e.length>0&&e.forEach(function(t){return t.remove()});E.getGroupPops(t)}function o(t){var e=paper.project.getItem({className:"Group",match:function(e){return e.id===t}});e&&e.children.length>0&&e.children.forEach(function(t){"loop"===t.name&&r(t)})}function r(t){var e=A.transparent,n=t.parent;t.data.interior?(t.data.transparent=!t.data.transparent,t.data.transparent?(t.fillColor=e,t.strokeColor=e):(t.fillColor=n.data.color,t.strokeColor=n.data.color),window.kan.moves.push({type:"fillChange",id:t.id,fill:n.data.color,transparent:t.data.transparent})):t.data&&t.data.pop===!0&&t.parent&&k.pop===!0&&o(t.parent.id)}function a(t){var e=["mask","outer","shapePath","loop","pop"];return t.children.forEach(function(t){(null===t.name||!e.includes(t.name)||!t.length>0)&&t.remove()}),t}function s(){var t=E.getFreshGroups(),e=E.getPopCandidates();E.getAllPops();e.reverse(),t.forEach(function(t,n){var i=t._namedChildren.mask[0];i.bringToFront(),e.forEach(function(e,n){var o=e._namedChildren.mask[0];if(t.id!==e.id){o.bringToFront();var r=i.intersect(o);if(r&&r.length>0){var s=A.getRandomPop();r.fillColor=s,r.strokeColor=s,r.data.pop=!0,r.name="pop",r.data.popGroup=t.id,r.data.intersectingGroup=e.id,r.visible=!0,r.closed=!0,r.bringToFront(),t.addChild(r)}a(t)}}),t.data.fresh=!1})}function u(t){var e=new Path;e.name="outer",e.visible=!0;var n=new Path;n.name="middle";var i=[],o=null,r=null,a=null,s=null,u=null,l=null;if(!(t.length>0))return new Group(e,n);n.add(t.firstSegment.point);for(var c=0;c<t.length;c+=10){for(;i.length>10;)i.shift();var p=9*Math.random();i.push(p);for(var d=0,f=0;f<i.length;f++)d+=i[f];var h=Math.max(5,(d/i.length+p)/2),y=t.getPointAt(c),_=t.getNormalAt(c),v=new Point(y.x+_.x*h,y.y+_.y*h),m=new Point(y.x-_.x*h,y.y-_.y*h);e.add(v),e.insert(0,m),n.add(y),r=o,10==c?(a=v,s=m):(u=v,l=m)}if(t.closed===!0){var g=new Point((a.x+u.x)/2,(a.y+u.y)/2),x=new Point((s.x+l.x)/2,(s.y+l.y)/2),w=new Point((g.x+x.x)/2,(g.y+x.y)/2);e.add(g),e.insert(0,x),n.add(w),e.add(a),e.insert(0,s),n.closed=!0}e.flatten(50),n.flatten(50),e.simplify(),n.simplify(),e.selected=!1,e.name="outer",n.name="middle";var b=new Group(e,n);return b}function l(t){var e=t.clone();e.visible=!1;var n=c(e),i=n;return i.strokeWidth=e.strokeWidth,e.remove(),i}function c(t){var e=t.clone();e.visible=!1,e.reduce(),e.simplify();var n=e.getIntersections();if(n.length>0){var i=x(e);return e.remove(),i}var o=m(e),r=o.getIntersections();if(r.length>0){var a=x(o);return o.remove(),a}if(o.replaceWith(g(e)),null!==o){var s=o.getIntersections();if(s.length>0){var u=x(o);return o.remove(),u}o&&o.length>0&&o.remove()}return e.visible=!0,e}function p(t){var e={},n=t.exportJSON(),i=_(n),o=S.spot(i);if(0===o.score?(e.pattern="line",e.score=.9):(o.score>.5?e.pattern=o.pattern:e.pattern="other",e.score=o.score),t.closed===!0){var r=["triangle","square","circle"];r.includes(e.pattern)===!1&&(e.pattern=E.randomPick(r))}else t.intersects(t)===!0?e.pattern="other":e.pattern="line";return e}function d(t){return new Point(Math.floor(t.x),Math.floor(t.y))}function f(t){return Math.floor(t.x)+","+Math.floor(t.y)}function h(t){var e=t.split(",").map(function(t){return Math.floor(t)});return e.length>=2?new Point(e[0],e[1]):null}function y(t,e){var n=void 0,i=void 0;return Base.each(e,function(e,o){var r=t.getDistance(e.point);(!n||r<n)&&(n=r,i=e.point)}),i||t}function _(t){var e=[],n=JSON.parse(t)[1];if("segments"in n){var i=n.segments;Base.each(i,function(t,n){if(3===t.length){var i=t[0];e.push({x:i[0],y:i[1]})}else e.push({x:t[0],y:t[1]})})}return e}function v(t){var e=A.transparent,n=[],i=t.clone(),o=i.getIntersections();if(o.length>0){var r=i.resolveCrossings();if("CompoundPath"===r.className)Base.each(r.children,function(t,o){if(t.length>0&&t.closed){var r=t.clone();i.closed?(r.fillColor=i.strokeColor,r.data.interior=!0,r.data.transparent=!1):(r.fillColor=e,r.data.transparent=!0),r.data.interior=!0,r.visible=!0,r.closed=!0,n.push(r)}});else if(i.closed){var a=i.clone();a.visible=!0,a.fillColor=i.strokeColor,a.data.interior=!0,a.data.transparent=!1,n.push(a)}}else if(i.closed){var s=i.clone();s.visible=!0,s.fillColor=i.strokeColor,s.data.interior=!0,s.data.transparent=!1,n.push(s)}return n}function m(t){var e=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],t.clone());e.visible=!1;var n=P*e.length,i=e.firstSegment,o=i.next,r=Math.atan2(o.point.y-i.point.y,o.point.x-i.point.x),a=r+Math.PI,s=new Point(i.point.x+Math.cos(a)*n/2,i.point.y+Math.sin(a)*n/2);e.insert(0,s);var u=e.lastSegment,l=u.previous,c=Math.atan2(u.point.y-l.point.y,u.point.x-l.point.x),p=new Point(u.point.x+Math.cos(c)*n/2,u.point.y+Math.sin(c)*n/2);return e.add(p),e}function g(t){var e=t.clone();e.visible=!1;var n=P*e.length,i=e.firstSegment.point,o=e.lastSegment.point;if(i.getDistance(o)<n){e.insert(0,o),e.add(i),e.closed=!0,e.unite();var r=e.resolveCrossings();r&&r.children&&r.children.length>0&&!function(){var t=0,n=null;r.children.forEach(function(e){e.area>t&&(n=e,t=e.area)}),e=n}()}return e}function x(t){var e=t.clone();e.visible=!1;var n=e.firstSegment.point,i=e.lastSegment.point,o=P*e.length,r=e.getIntersections();if(r.forEach(function(t,e){0===t.offset&&r.splice(e,1)}),1==r.length){for(var a=0;a<r.length;a++){var s=r[a].point;if(n.getDistance(s)+i.getDistance(s)<2*o){var u=e.clone();u.visible=!1;var l=u.resolveCrossings();if("CompoundPath"===l.className&&l.children.length>0)for(var c=0;c<l.children.length;c++){var p=l.children[c];p.closed&&(u=u.subtract(p))}var d=e.subtract(u);if(0===d.length)return e;if("CompoundPath"===d.className&&d.children.length>0){var f=function(){var t=[];if(d.children.forEach(function(e,n){if(e.length>0&&e.closed){var i=e.clone();i.visible=!1,t.push(i)}}),t.length>0){if(t.length>1){for(var n=t[0],i=1;i<t.length;i++)n=n.unite(t[i]);if(n.length>0&&"Path"===n.className){var o=new Path;return o.copyContent(n),o.copyAttributes(e),n.remove(),e.remove(),u.remove(),d.remove(),{v:o}}}return e.remove(),u.remove(),d.remove(),{v:t[0]}}}();if("object"===("undefined"==typeof f?"undefined":C(f)))return f.v}return e.remove(),u.remove(),d}}return e}return t}function w(t){var e=E.getVisibleGroups();return b(t,e)}function b(t,e){if(!t)return null;for(var n=e.length-1;n>=0;n--){var i=e[n];i.strokeBounds;if(t.isInside(i.strokeBounds))return i}return null}Object.defineProperty(n,"__esModule",{value:!0});var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.destroyGroupPops=i,n.fillInGroupPopsById=o,n.toggleFill=r,n.cleanUpGroup=a,n.updatePops=s,n.getOutlineGroup=u,n.getTruedShape=l,n.getCompletedPath=c,n.getShapePrediction=p,n.getIntegerPoint=d,n.stringifyPoint=f,n.parsePoint=h,n.getClosestPointFromPathData=y,n.processShapeData=_,n.findInteriorCurves=v,n.getExtendedPath=m,n.getBruteExtendedPath=g,n.getTrimmedPath=x,n.hitTestGroupBounds=w,n.hitTestBounds=b;var T=t("./lib/shape-detector"),k=t("./../../config"),E=t("./util"),A=t("./color"),P=(n.cornerThresholdDeg=30,n.thresholdDistMultiplier=.1),S=n.detector=new T(T.defaultShapes);n.shapeNames=["line","circle","square","triangle","other"]},{"./../../config":1,"./color":6,"./lib/shape-detector":7,"./util":16}],11:[function(t,e,n){"use strict";function i(){return l()}function o(){return l()}function r(t){var e=paper.view.viewSize.width,n=(paper.view.viewSize.height,window.kan.shapeSounds||initShapeSounds()),i=b.getShapePrediction(t),o=C.getPathColorName(t);null===o&&(o="black");var r=p(t.bounds.x/e*I),a=p(t.bounds.width/e*I),s={};return s.sound=n[i.pattern],s.startTime=r,s.duration=a,s.pathId=t.id,s.spriteName=o,s.groupId=t.parent.id,s.play=function(){return new w(function(t,e){s.sound.play(s.spriteName),s.sound.on("end",function(){t("Group "+s.groupId+" done playing")}),s.sound.on("loaderror",function(){e("Group "+s.groupId+" failed to load sound")})})},s}function a(){A.hasClass(M)?(A.addClass(O),Howler.mute(!1),window.kan.playing=!0,window.kan.firstTimePlaying===!0?(window.kan.firstTimePlaying=!1,_(window.kan.composition,!1)):_(window.kan.composition,!0)):(window.kan.playing=!1,A.removeClass(O))}function s(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&Howler.mute(!0),window.kan.playing=!1,A.removeClass(O),v()}function u(t){var e="./audio/shapes/"+t+"/"+t+".json";return $.getJSON(e).then(function(e){var n=c(t,e),i=new Howl(n);return{shapeName:t,sound:i}})}function l(){var t=b.shapeNames,e=[];return Base.each(t,function(t){e.push(u(t))}),$.when.apply($,e).done(function(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];t[n.shapeName]=n.sound}return window.kan.shapeSounds=t,t})}function c(t,e){var n={};return n.src=e.urls.map(function(e){return"./audio/shapes/"+t+"/"+e}),n.sprite=e.sprite,n.html5=!0,n.loop=!1,n}function p(t){var e=60/S,n=Math.floor(t/e)*e;return n>0?n:e}function d(t,e){var n=e/(4*P);return returnPosition=Math.floor(t/n)*n}function f(t){var e=paper.project.getItem({className:"Path",match:function(e){return e.id===t.pathId}});if(e){var n=e.parent;n.data.animating=!0;var i=j/2;n.animate([{properties:{scale:1,rotate:-5},settings:{duration:i/4,easing:"easeInOut"}},{properties:{scale:1.15,rotate:5},settings:{duration:i/2,easing:"easeInOut"}},{properties:{scale:1,rotate:0},settings:{duration:i/4,easing:"easeInOut",complete:function(){this.data.animating=!1}}}])}}function h(t){for(var e=(function(e){var n=window.kan.composition[e];if("groupId"in n){if(n.groupId===t.id)return window.kan.composition.splice(e,1),{v:void 0}}else if("pathId"in n){var i=getItems({match:function(t){return t.id===n.pathId}});if(i.length>0&&i.parent&&"Group"===i.parent.className&&i.parent.id===t.id)return window.kan.composition.splice(e,1),{v:void 0}}}),n=0;n<window.kan.composition.length;n++){var i=e(n);if("object"===("undefined"==typeof i?"undefined":x(i)))return i.v}}function y(){window.kan.soundTimeouts.length>0&&window.kan.soundTimeouts.forEach(function(t){clearTimeout(t)}),window.kan.soundTimeouts=[]}function _(t){function e(){y();var e=m(t);Base.each(e.composition,function(t,e){var n=setTimeout(function(){window.kan.playing&&null!==t.spriteName&&(t.play(),f(t))},t.startTime);window.kan.soundTimeouts.push(n)}),r++,window.kan.compositionTimeout=setTimeout(i,I-e.startTime)}function n(){y(),Base.each(t,function(t,e){var n=setTimeout(function(){window.kan.playing&&(t.sound.play(t.spriteName),f(t))},t.startTime);window.kan.soundTimeouts.push(n)}),r++}function i(){o===!0?(n(),window.kan.compositionInterval=setInterval(n,I)):r<2?(n(),setTimeout(i,I)):(s(),T.openOverlay("share-prompt"))}var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v(),k.hideContextualTuts(),clearTimeout(window.kan.playPromptTimeout);var r=0;e()}function v(){clearInterval(window.kan.compositionInterval),clearTimeout(window.kan.compositionTimeout),y()}function m(t){var e=[],n=g(t);return t.forEach(function(t){var i=E.shallowCopy(t);i.startTime=t.startTime-n,i.startTime<0&&(i.startTime=0),e.push(i)}),{composition:e,startTime:n}}function g(t){var e=I;return t.forEach(function(t){"startTime"in t&&t.startTime<e&&(e=t.startTime);
}),e!==I?e:0}Object.defineProperty(n,"__esModule",{value:!0});var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.init=i,n.reinitShapeSounds=o,n.getShapeSoundObj=r,n.startPlaying=a,n.stopPlaying=s,n.asyncInitShapeSounds=l,n.formatShapeSoundData=c,n.quantizeLength=p,n.quantizePosition=d,n.removeShapeFromComposition=h,n.clearSoundTimeouts=y,n.startComposition=_,n.stopComposition=v,n.getTrimmedCompositionObj=m,t("howler");var w=t("bluebird"),b=(t("./ui"),t("./shape")),C=t("./color"),T=t("./overlays"),k=t("./tutorial"),E=t("./util"),A=$("body"),P=4,S=120,F=60/S*1e3,j=4*F,I=n.compositionLength=j*P,O=n.playingClass="playing",M=n.playEnabledClass="play-enabled"},{"./color":6,"./overlays":9,"./shape":10,"./tutorial":14,"./ui":15,"./util":16,bluebird:2,howler:4}],12:[function(t,e,n){"use strict";function i(){window.location.hash.length>0&&"#dev"==window.location.hash?(window.kan.overlays=!1,a.pauseVideo(),a.exitTutorialMode()):a.enterTutorialMode()}function o(){console.log("prevent timeout: "+s.getTime()),clearTimeout(window.kan.inactivityTimeout),clearInterval(window.kan.continueCountdownInterval),window.kan.inactivityTimeout=setTimeout(function(){r.openOverlay("continue")},u)}Object.defineProperty(n,"__esModule",{value:!0}),n.init=i,n.preventInactivityTimeout=o;var r=t("./overlays"),a=t("./video"),s=t("./util"),u=($("body"),n.drawInactivityDelay=4e4);n.continueInactivityDelay=3e4,n.playPromptDelay=6e4,n.inputDelay=100,n.refreshCheckDelay=6e4,n.overlayDelay=1e3},{"./overlays":9,"./util":16,"./video":17}],13:[function(t,e,n){"use strict";function i(){n.hammerTips=G=new Hammer.Manager(P.tipsOverlay),G.add(new Hammer.Swipe({direction:Hammer.DIRECTION_ALL})),G.on("swipe",A.cardNavNext),n.hammerCanvas=H=new Hammer.Manager(P.canvas),H.add(new Hammer.Tap({event:"doubletap",taps:2,interval:400,time:150,posThreshold:50})),H.add(new Hammer.Tap({event:"singletap"})),H.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL})),H.add(new Hammer.Pinch),H.get("doubletap").recognizeWith("singletap"),H.get("pan").requireFailure("pinch"),H.get("pinch").requireFailure("pan"),H.on("doubletap",p),H.on("panstart",d),H.on("panmove",f),H.on("panend",h),H.on("pinchstart",y),H.on("pinchmove",_),H.on("pinchend",v)}function o(){s(),l()}function r(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t=t===!0,H.get("singletap").set({enable:t}),H.get("doubletap").set({enable:t})}function a(){r(!1)}function s(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t=t===!0,H.get("pan").set({enable:t})}function u(){s(!1)}function l(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t=t===!0,H.get("pinch").set({enable:t})}function c(){l(!1)}function p(t){t.preventDefault();var e=t.center,n=new Point(e.x,e.y),i=paper.project.hitTest(n,F);g(t)&&(i?(C.toggleFill(i.item),k.hideContextualTutByName("fill")):window.kan.pinchedGroup=null)}function d(t){if(E.preventInactivityTimeout(),!g(t))return window.kan.panning=!1,S.hasClass("overlay-active tips-active")&&A.cardNavNext(),void t.srcEvent.stopPropagation();window.kan.panning=!0,k.hideContextualTuts(),H.off("panstart"),c(),a(),w.stopPlaying(),window.kan.prevAngle=Math.atan2(t.velocityY,t.velocityX);var e=t.center,n=new Point(e.x,e.y);M=new Path,M.fillColor=window.kan.currentColor,D=[];var i=new Path({strokeColor:window.kan.currentColor,name:"shapePath",strokeWidth:5,visible:!1,strokeCap:"round"});i.add(n),window.kan.pathData[C.stringifyPoint(n)]={point:n,first:!0},window.kan.shapePath=i}function f(t){if(!g(t))return void t.srcEvent.stopPropagation();if(window.kan.panning===!0){if(window.kan.shapePath.length<=I){var e=t.center,n=new Point(e.x,e.y),i=Math.atan2(t.velocityY,t.velocityX),o=window.kan.prevAngle;T.angleDelta(i,o);for(window.kan.prevAngle=i;D.length>10;)D.shift();if(D.length>0){B.getDistance(n);R=10*Math.random(),N=0;for(var r=0;r<D.length;r++)N+=D[r];var a=Math.max(5,(N/D.length+R)/2),s=(n.x+B.x)/2,u=(n.y+B.y)/2,l=new Point(s,u),c=l.x+Math.cos(i-Math.PI/2)*a,p=l.y+Math.sin(i-Math.PI/2)*a,d=new Point(c,p),f=l.x+Math.cos(i+Math.PI/2)*a,h=l.y+Math.sin(i+Math.PI/2)*a,y=new Point(f,h);M.add(d),M.insert(0,y),M.smooth()}else R=5;D.push(R),B=n,window.kan.pathData[C.stringifyPoint(n)]={point:n,speed:Math.abs(t.overallVelocity),angle:i},window.kan.shapePath.add(n)}else window.kan.shapePath.data.tooLong=!0;paper.view.draw()}}function h(t){if(!g(t))return void t.srcEvent.stopPropagation();if(window.kan.panning===!0){var e=t.center,n=new Point(e.x,e.y),i=(b.transparent,b.getColorName(window.kan.currentColor),{type:"newGroup"}),a=window.kan.shapePath;if(a.length<=I&&a.add(n),M.visible=!1,a.length<j||a.data&&a.data.tooLong===!0)return a.remove(),H.on("panstart",d),o(),r(),void(window.kan.panning=!1);var s=T.getVisibleGroups();if(s.length>=x.maxShapes){var u=s[0];C.destroyGroupPops(u),w.removeShapeFromComposition(u),i.removedGroup=u,u.visible=!1}window.kan.pathData[C.stringifyPoint(n)]={point:n,last:!0};var l=new Group,c=C.getTruedShape(a),p=c.strokeBounds,f=new Point(p.width/2,p.height/2),h=T.rad(360*Math.random()),y=(p.width+p.height)/4,_=f.x+Math.cos(h-Math.PI/2)*y,v=f.y+Math.sin(h-Math.PI/2)*y,m=f.x+Math.cos(h+Math.PI/2)*y,F=f.y+Math.sin(h+Math.PI/2)*y,O=new Point(_+p.x,v+p.y),D=new Point(m+p.x,F+p.y);if(l.data.originalColor=window.kan.currentColor,l.data.color={gradient:{stops:x.palette.gradients[window.kan.currentColor]},origin:O,destination:D},l.data.scale=1,l.data.rotation=0,l.data.fresh=!0,a.remove(),c.visible=!1,c.strokeColor=new Color(0,0),window.kan.shapePath=c,c.name="shapePath",!(c.length>0))return c.remove(),l.remove(),void(window.kan.panning=!1);l.addChild(c);var R=w.getShapeSoundObj(c);window.kan.composition.push(R),c.visible=!1;var N=C.getOutlineGroup(c),B=N._namedChildren.outer[0].clone();B.name="outer",B.fillColor=window.kan.currentColor,B.fillColor=l.data.color;var G=N._namedChildren.middle[0].clone();G.strokeColor=l.data.color,G.visible=!1,l.addChild(B),B.sendToBack(),N.remove();var L=B.clone();L.fillColor=B.fillColor,L.strokeColor=B.strokeColor,L.closed=!0;var V=C.findInteriorCurves(G);V.length>0||c.closed===!0?l.data.line=!1:l.data.line=!0,V.forEach(function(t){L.unite(t),L.sendToBack(),t.name="loop",t.data.loop=!0,t.visible=!0,l.addChild(t)}),L.unite();var q=L.resolveCrossings();if(q&&q.children&&q.children.length>0&&!function(){var t=0,e=null;q.children.forEach(function(n){n.area>t&&(e=n,t=n.area)}),L=e}(),G.remove(),L.visible=!1,L.name="mask",L.data.mask=!0,l.addChild(L),L.sendToBack(),C.cleanUpGroup(l),i.id=l.id,window.kan.moves.push(i),P.unditherButtonsByName(["new","undo","play-stop","share"]),S.addClass(w.playEnabledClass),window.kan.userHasDrawnFirstShape!==!0&&(window.kan.playPromptTimeout=setTimeout(function(){A.openOverlay("play-prompt")},E.playPromptDelay),window.kan.userHasDrawnFirstShape=!0),x.runAnimations){var $=.9;l.animate([{properties:{scale:$},settings:{duration:100,easing:"easeOut"}},{properties:{scale:1/$},settings:{duration:100,easing:"easeIn"}}])}if(!k.allTutsCompleted()){var U=window.kan.tutorialCompletion,z=null;if(!U.fill&&c.closed)z="fill";else{var X=paper.project.getItems({match:function(t){return"Group"===t.className}});!U.pinch&&X.length>=3?z="pinch":!U.swipe&&X.length>=5&&(z="swipe")}null!==z&&(k.addContextualTut(z),window.kan.tutorialCompletion[z]=!0,l.data.tut=z)}null!==window.kan.scheduledOverlay&&!function(){var t=window.kan.scheduledOverlay;window.kan.scheduledOverlay=null,setTimeout(function(){A.openOverlay(t)},E.overlayDelay)}(),R.play(),H.set({enable:!1}),setTimeout(function(){H.set({enable:!0}),console.log("touch enabled"),H.on("panstart",d),o(),r(),window.kan.panning=!1},E.inputDelay),x.pop===!0&&C.updatePops()}}function y(t){if(E.preventInactivityTimeout(),k.hideContextualTuts(),window.kan.interacting=!0,window.kan.pinching=!0,H.off("pinchstart"),u(),a(),g(t)){w.stopPlaying();var e=t.center,n=new Point(e.x,e.y),i=C.hitTestGroupBounds(n);if(i)if(window.kan.pinching=!0,window.kan.pinchedGroup=i,window.kan.lastScale=1,window.kan.lastRotation=t.rotation,window.kan.originalPosition=i.position,window.kan.originalRotation=i.data.rotation,window.kan.originalScale=i.data.scale,i.data.thrown=!1,x.pop===!0&&C.destroyGroupPops(i),i.bringToFront(),i.data.tut&&i.data.tut.length>0){var o=$(".tut[data-tut-type='"+i.data.tut+"']");o?window.kan.pinchedTut=o:window.kan.pinchedTut=null}else window.kan.pinchedTut=null;else window.kan.pinchedGroup=null,window.kan.pinchedTut=null}}function _(t){var e=(paper.view.viewSize.width,paper.view.viewSize.height,window.kan.pinchedGroup),n=window.kan.pinchedTut;if(e){var i=t.scale,o=void 0;k.hideContextualTutByName("pinch"),o=e.bounds.width<j||e.bounds.height<j?1.1:e.bounds.width>=paper.view.viewSize.width||e.bounds.height>=paper.view.viewSize.height?.9:i/window.kan.lastScale,window.kan.lastScale=i;var r=t.rotation,a=r-window.kan.lastRotation;window.kan.lastRotation=r;var s=t.center;if(e.position=s,n&&k.moveContextualTut(n,s),1!==o){e.scale(o);var u=T.hypot(e.bounds.width,e.bounds.height),l=T.hypot(paper.view.viewSize.width,paper.view.viewSize.height);u>=l?(o=l*O/u,e.scale(o)):u<=j&&(o=j/u,e.scale(o))}e.rotate(a),e.data.scale*=o,e.data.rotation+=a}}function v(t){window.kan.lastEvent=t;var e=window.kan.pinchedGroup,n=window.kan.pinchedTut,i=window.kan.originalPosition,a=window.kan.originalRotation,s=window.kan.originalScale;if(e){e.data.fresh=!0;var u={id:e.id,type:"transform"};if(e.position!=i&&(u.position=i),e.data.rotation!=a&&(u.rotation=a-e.data.rotation),e.data.scale!=s&&(u.scale=s/e.data.scale),e.children.length>0&&e._namedChildren.shapePath&&e._namedChildren.shapePath.length>0){w.removeShapeFromComposition(e);var l=e._namedChildren.shapePath[0],c=w.getShapeSoundObj(l);window.kan.composition.push(c)}window.kan.moves.push(u),Math.abs(t.velocity)>1&&(k.hideContextualTutByName("swipe"),n&&k.hideContextualTut(n),x.pop===!0&&(C.destroyGroupPops(e),e.data.fresh=!1),e.data.thrown=!0,m())}else window.kan.pinchedGroup=null;null!==window.kan.scheduledOverlay&&!function(){var t=window.kan.scheduledOverlay;window.kan.scheduledOverlay=null,setTimeout(function(){A.openOverlay(t)},E.overlayDelay)}(),window.kan.pinching=!1,x.pop===!0&&C.updatePops(),setTimeout(function(){console.log("touch enabled"),H.on("pinchstart",y),o(),r()},E.inputDelay)}function m(){var t=25,e=window.kan.lastEvent,n=paper.view.viewSize.width,i=paper.view.viewSize.height,o=window.kan.pinchedGroup;if(!(null===o||o.data&&o.data.thrown===!1)){if(o.position.x<=0-o.bounds.width||o.position.x>=n+o.bounds.width||o.position.y<=0-o.bounds.height||o.position.y>=i+o.bounds.height)return o.data.offScreen=!0,o.visible=!1,w.removeShapeFromComposition(o),void(window.kan.pinchedGroup=null);requestAnimationFrame(m);var r=o.position.x+e.velocityX*t,a=o.position.y+e.velocityY*t,s=new Point(r,a);o.position=s}}function g(t){return!!t&&t.target==P.canvas}Object.defineProperty(n,"__esModule",{value:!0}),n.init=i,t("hammerjs");var x=t("./../../config"),w=t("./sound"),b=t("./color"),C=t("./shape"),T=t("./util"),k=t("./tutorial"),E=t("./timing"),A=t("./overlays"),P=t("./ui"),S=$("body"),F={segments:!1,stroke:!0,fill:!0,tolerance:5},j=100,I=5e3,O=.8,M=void 0,D=[],R=void 0,N=void 0,B=void 0,G=n.hammerTips=void 0,H=n.hammerCanvas=void 0},{"./../../config":1,"./color":6,"./overlays":9,"./shape":10,"./sound":11,"./timing":12,"./tutorial":14,"./ui":15,"./util":16,hammerjs:3}],14:[function(t,e,n){"use strict";function i(t){for(var e=0;e<f.length;e++){var n=f[e];if(n.type===t)return n.copy}return null}function o(){var t=window.kan.tutorialCompletion,e=!0;return Object.keys(t).forEach(function(n,i){e=e&&t[n]}),e===!0}function r(t){if(window.kan.shapePath&&window.kan.shapePath.length>0){u(),window.kan.shapesSinceTut=0;var e=window.kan.shapePath,n=e.bounds.center,o=i(t);if(null!==o){var r=$(".tut[data-tut-type='"+t+"']");if(r.length>0){var a=p(r,n);r.css({top:a.y+"px",left:a.x+"px",visibility:"visible"}),r.addClass("animated bounceIn")}}}}function a(t){t.css({visibility:"hidden"})}function s(t){var e=$(".tut[data-tut-type='"+t+"']");a(e)}function u(){var t=$(".contextual-tuts .tut");t.css({visibility:"hidden"})}function l(){u(),window.kan.tutorialCompletion={fill:!1,pinch:!1,swipe:!1}}function c(t,e){var n=p(t,e);t.css({top:n.y+"px",left:n.x+"px"})}function p(t,e){var n=t.outerWidth(),i=t.outerHeight(),o=e.x-n/2,r=e.y-i-h;return new Point(o,r)}Object.defineProperty(n,"__esModule",{value:!0}),n.getTutByName=i,n.allTutsCompleted=o,n.addContextualTut=r,n.hideContextualTut=a,n.hideContextualTutByName=s,n.hideContextualTuts=u,n.resetContextualTuts=l,n.moveContextualTut=c,n.getTutPositionFromCenter=p;var d=t("./../../config"),f=d.contextualTuts,h=16},{"./../../config":1}],15:[function(t,e,n){"use strict";function i(){d(),f(),h(),y(),_(),v(),m(),g(),x()}function o(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.length>0&&($.isArray(t)?t.forEach(function(t){return a(t,e)}):a(t,e))}function r(t){o(t,!0)}function a(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=$(".controls ."+t);n.length>0&&(e!==!0?n.addClass(F):n.removeClass(F))}function s(t){a(t,!0)}function r(t){o(t,!0)}function u(){window.kan.composition=[],paper.project.activeLayer.removeChildren(),C.hideContextualTuts(),o(["undo","new","play-stop","share"]),b.stopPlaying()}function l(){b.stopPlaying(),C.hideContextualTuts();var t=new Color(0,0);if(!(window.kan.moves.length>0))return void(window.kan.userHasDrawnFirstShape=!1);var e=window.kan.moves.pop(),n=project.getItem({id:e.id});if(n)switch(n.visible=!0,e.type){case"newGroup":b.removeShapeFromComposition(n),k.clearGroupPops(n),n.remove(),"removedGroup"in e&&(e.removedGroup.visible=!0,e.removedGroup.data.fresh=!0,E.updatePops());var i=k.getNumGroups();i<=0?(o(["undo","new","play-stop","share"]),A.removeClass(b.playEnabledClass)):(r(["undo","new","play-stop","share"]),A.addClass(b.playEnabledClass));break;case"fillChange":e.transparent?(n.fillColor=e.fill,n.strokeColor=e.fill):(n.fillColor=t,n.strokeColor=t);case"transform":if(n.data.fresh=!0,e.position&&(n.position=e.position,n.data&&n.data.tut&&n.data.tut.length>0)){var a=$(".tut[data-tut-type='"+tutName+"']");C.moveContextualTut(a,e.position)}e.rotation&&(n.rotation=e.rotation),e.scale&&n.scale(e.scale),w.pop===!0&&E.updatePops()}}function c(){b.stopPlaying(),T.openOverlay("tips")}function p(){b.stopPlaying(),A.hasClass(b.playEnabledClass)&&T.openOverlay("share")}function d(){$(".main-logo").on(P,function(){location.reload()})}function f(){var t=$("ul.palette-colors"),e=t.find("li"),n=20,i=30,o="palette-selected";e.on("click tap touch",function(){if(!A.hasClass(S)){var t=$(this).find("svg.palette-color");t.hasClass(o)||($("."+o).removeClass(o).attr("width",n).attr("height",n).find("rect").attr("rx",0).attr("ry",0),t.addClass(o).attr("width",i).attr("height",i).find("rect").attr("rx",i/2).attr("ry",i/2),window.kan.currentColor=t.find("rect").attr("fill"))}})}function h(){$(".main-controls .new").on(P,function(){A.hasClass(S)||u()})}function y(){$(".main-controls .undo").on(P,function(){A.hasClass(S)||l()})}function _(){$(".main-controls .play-stop .play").on(P,b.startPlaying),$(".main-controls .play-stop .stop").on(P,b.stopPlaying)}function v(){$(".controls .tips").on(P,function(){A.hasClass(S)||c()})}function m(){$(".controls .share").on(P,function(){A.hasClass(S)||p()})}function g(){var t=$(".contextual-tuts .tut");t.on(P,function(){$(this).css({visibility:"hidden"})})}function x(){paper.project.clear(),paper.project.activeLayer.name="background";var t=10,e=Math.round(Math.random()*(t-1))+1,n=new Raster("canvas-"+e);n.name="canvasBg",n.position=paper.view.center;var i=paper.view.viewSize.width/n.size.width,o=paper.view.viewSize.height/n.size.height;n.scale(Math.max(i,o));new Layer;paper.project.activeLayer.name="canvas"}Object.defineProperty(n,"__esModule",{value:!0}),n.init=i,n.ditherButtonsByName=o,n.unditherButtonsByName=r,n.ditherButtonByName=a,n.unditherButtonByName=s,n.resetCanvas=x;var w=t("./../../config"),b=t("./sound"),C=t("./tutorial"),T=t("./overlays"),k=t("./util"),E=(t("./color"),t("./shape")),A=$("body"),P="click tap touch",S=b.playingClass,F=(b.playEnabledClass,$(".controls .new"),$(".controls .undo"),$(".controls .play-stop"),$(".controls .share"),$(".controls .tips"),n.canvas=$("#canvas")[0],n.tipsOverlay=$(".overlay.tips")[0],"dithered")},{"./../../config":1,"./color":6,"./overlays":9,"./shape":10,"./sound":11,"./tutorial":14,"./util":16}],16:[function(t,e,n){"use strict";function i(t){return t*Math.PI/180}function o(t){return 180*t/Math.PI}function r(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function a(t,e){return Math.abs(Math.atan2(Math.sin(e-t),Math.cos(e-t)))}function s(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function u(){return(new Date).toLocaleTimeString()}function l(){var t=c();return t.length}function c(){return paper.project.getItems({className:"Group",match:function(t){return t.visible===!0}})}function p(){return paper.project.getItems({className:"Group"})}function d(){var t=c();return t.length>0}function f(){var t=c();return t.length}function h(){return paper.project.getItems({className:"Group",match:function(t){return t.data&&t.data.line===!1&&t.data.fresh===!0}})}function y(){return paper.project.getItems({match:function(t){return t.data&&t.data.pop===!0}})}function _(t){var e=v(t);e.forEach(function(t){return t.remove()})}function v(t){var e=[];if(t.children.length>0){var n=t.getItems({match:function(t){return t.data&&t.data.pop===!0}});e=e.concat(n)}var i=paper.project.getItems({match:function(e){return e.data&&e.data.pop===!0&&e.data.intersectingGroup===t.id}});return i.length>0&&(e=e.concat(i)),e}function m(){return paper.project.getItems({className:"Group",match:function(t){return t.data&&t.data.line===!1&&t.visible===!0}})}function g(){$.get("/hash").done(function(t){console.log("current hash:",t),window.kan.hash=t}).fail(function(t){console.error("error getting hash:",t)})}function x(t){var e,n=Object.create(Object.getPrototypeOf(t)),i=Object.getOwnPropertyNames(t);for(e=0;e<i.length;e++)Object.defineProperty(n,i[e],Object.getOwnPropertyDescriptor(t,i[e]));return n}function w(t){return t.length>0?t[Math.floor(Math.random()*t.length)]:null}Object.defineProperty(n,"__esModule",{value:!0}),n.rad=i,n.deg=o,n.hypot=r,n.angleDelta=a,n.delta=s,n.getTime=u,n.getNumVisibleGroups=l,n.getVisibleGroups=c,n.getAllGroups=p,n.anyShapesOnCanvas=d,n.getNumGroups=f,n.getFreshGroups=h,n.getAllPops=y,n.clearGroupPops=_,n.getGroupPops=v,n.getPopCandidates=m,n.setSha=g,n.shallowCopy=x,n.randomPick=w;t("./../../config")},{"./../../config":1}],17:[function(t,e,n){"use strict";function i(){console.log("entering tutorial mode"),a(),d.addClass(h),clearTimeout(window.kan.inactivityTimeout),clearInterval(window.kan.continueCountdownInterval),d.off(f,l.preventInactivityTimeout),d.on(f,o),s.resetWindow(),c.resetCanvas(),window.kan.refreshCheckInterval=setInterval(function(){$.get("/hash").done(function(t){t!==window.kan.hash&&(console.log("different hash, reloading"),location.reload())}).fail(function(t){console.error("error getting hash:",t)})},l.refreshCheckDelay)}function o(){console.log("exiting tutorial mode"),p.reinitShapeSounds().then(function(){clearInterval(window.kan.refreshCheckInterval),Howler.mute(!1),r(),d.off(f,o),d.on(f,l.preventInactivityTimeout),d.removeClass(h),clearTimeout(window.kan.inactivityTimeout),clearInterval(window.kan.continueCountdownInterval),u.openOverlay("intro"),window.kan.inactivityTimeout=setTimeout(function(){u.openOverlay("continue")},l.continueInactivityDelay)}).fail(function(t){console.error("error initting shape sounds:",t),location.reload()})}function r(){_.get(0).pause()}function a(){_.get(0).play()}Object.defineProperty(n,"__esModule",{value:!0}),n.enterTutorialMode=i,n.exitTutorialMode=o,n.pauseVideo=r,n.playVideo=a;var s=(t("./../../config"),t("./main")),u=t("./overlays"),l=t("./timing"),c=t("./ui"),p=t("./sound"),d=$("body"),f="click tap touch",h=n.videoPlayingClass="video-playing",y=d.find("#video-wrap"),_=y.find("video")},{"./../../config":1,"./main":8,"./overlays":9,"./sound":11,"./timing":12,"./ui":15}]},{},[8]);
//# sourceMappingURL=maps/main.js.map
